"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@edgestore";
exports.ids = ["vendor-chunks/@edgestore"];
exports.modules = {

/***/ "(ssr)/./node_modules/@edgestore/react/dist/index.mjs":
/*!******************************************************!*\
  !*** ./node_modules/@edgestore/react/dist/index.mjs ***!
  \******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createEdgeStoreProvider: () => (/* binding */ createEdgeStoreProvider)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\");\n\n\nclass EdgeStoreError extends Error {\n    constructor(message){\n        super(message);\n        this.name = 'EdgeStoreError';\n    }\n}\n\nfunction createNextProxy({ apiPath, uploadingCountRef, maxConcurrentUploads = 5 }) {\n    return new Proxy({}, {\n        get (_, prop) {\n            const bucketName = prop;\n            const bucketFunctions = {\n                upload: async (params)=>{\n                    try {\n                        params.onProgressChange?.(0);\n                        while(uploadingCountRef.current >= maxConcurrentUploads && uploadingCountRef.current > 0){\n                            await new Promise((resolve)=>setTimeout(resolve, 300));\n                        }\n                        uploadingCountRef.current++;\n                        return await uploadFile(params, {\n                            bucketName: bucketName,\n                            apiPath\n                        });\n                    } finally{\n                        uploadingCountRef.current--;\n                    }\n                },\n                confirmUpload: async (params)=>{\n                    const { success } = await confirmUpload(params, {\n                        bucketName: bucketName,\n                        apiPath\n                    });\n                    if (!success) {\n                        throw new EdgeStoreError('Failed to confirm upload');\n                    }\n                },\n                delete: async (params)=>{\n                    const { success } = await deleteFile(params, {\n                        bucketName: bucketName,\n                        apiPath\n                    });\n                    if (!success) {\n                        throw new EdgeStoreError('Failed to delete file');\n                    }\n                }\n            };\n            return bucketFunctions;\n        }\n    });\n}\nasync function uploadFile({ file, input, onProgressChange, options }, { apiPath, bucketName }) {\n    try {\n        onProgressChange?.(0);\n        const res = await fetch(`${apiPath}/request-upload`, {\n            method: 'POST',\n            body: JSON.stringify({\n                bucketName,\n                input,\n                fileInfo: {\n                    extension: file.name.split('.').pop(),\n                    type: file.type,\n                    size: file.size,\n                    fileName: options?.manualFileName,\n                    replaceTargetUrl: options?.replaceTargetUrl,\n                    temporary: options?.temporary\n                }\n            }),\n            headers: {\n                'Content-Type': 'application/json'\n            }\n        });\n        const json = await res.json();\n        if ('multipart' in json) {\n            await multipartUpload({\n                bucketName,\n                multipartInfo: json.multipart,\n                onProgressChange,\n                file,\n                apiPath\n            });\n        } else if ('uploadUrl' in json) {\n            // Single part upload\n            // Upload the file to the signed URL and get the progress\n            await uploadFileInner(file, json.uploadUrl, onProgressChange);\n        } else {\n            throw new EdgeStoreError('An error occurred');\n        }\n        return {\n            url: getUrl(json.accessUrl, apiPath),\n            thumbnailUrl: json.thumbnailUrl ? getUrl(json.thumbnailUrl, apiPath) : null,\n            size: json.size,\n            uploadedAt: new Date(json.uploadedAt),\n            path: json.path,\n            pathOrder: json.pathOrder,\n            metadata: json.metadata\n        };\n    } catch (e) {\n        onProgressChange?.(0);\n        throw e;\n    }\n}\n/**\n * Protected files need third-party cookies to work.\n * Since third party cookies doesn't work on localhost,\n * we need to proxy the file through the server.\n */ function getUrl(url, apiPath) {\n    if ( true && !url.includes('/_public/')) {\n        const proxyUrl = new URL(window.location.origin);\n        proxyUrl.pathname = `${apiPath}/proxy-file`;\n        proxyUrl.search = new URLSearchParams({\n            url\n        }).toString();\n        return proxyUrl.toString();\n    }\n    return url;\n}\nconst uploadFileInner = async (file, uploadUrl, onProgressChange)=>{\n    const promise = new Promise((resolve, reject)=>{\n        const request = new XMLHttpRequest();\n        request.open('PUT', uploadUrl);\n        request.addEventListener('loadstart', ()=>{\n            onProgressChange?.(0);\n        });\n        request.upload.addEventListener('progress', (e)=>{\n            if (e.lengthComputable) {\n                // 2 decimal progress\n                const progress = Math.round(e.loaded / e.total * 10000) / 100;\n                onProgressChange?.(progress);\n            }\n        });\n        request.addEventListener('error', ()=>{\n            reject(new Error('Error uploading file'));\n        });\n        request.addEventListener('abort', ()=>{\n            reject(new Error('File upload aborted'));\n        });\n        request.addEventListener('loadend', ()=>{\n            // Return the ETag header (needed to complete multipart upload)\n            resolve(request.getResponseHeader('ETag'));\n        });\n        request.send(file);\n    });\n    return promise;\n};\nasync function multipartUpload(params) {\n    const { bucketName, multipartInfo, onProgressChange, file, apiPath } = params;\n    const { partSize, parts, totalParts, uploadId, key } = multipartInfo;\n    const uploadingParts = [];\n    const uploadPart = async (params)=>{\n        const { part, chunk } = params;\n        const { uploadUrl } = part;\n        const eTag = await uploadFileInner(chunk, uploadUrl, (progress)=>{\n            const uploadingPart = uploadingParts.find((p)=>p.partNumber === part.partNumber);\n            if (uploadingPart) {\n                uploadingPart.progress = progress;\n            } else {\n                uploadingParts.push({\n                    partNumber: part.partNumber,\n                    progress\n                });\n            }\n            const totalProgress = Math.round(uploadingParts.reduce((acc, p)=>acc + p.progress * 100, 0) / totalParts) / 100;\n            onProgressChange?.(totalProgress);\n        });\n        if (!eTag) {\n            throw new EdgeStoreError('Could not get ETag from multipart response');\n        }\n        return {\n            partNumber: part.partNumber,\n            eTag\n        };\n    };\n    // Upload the parts in parallel\n    const completedParts = await queuedPromises({\n        items: parts.map((part)=>({\n                part,\n                chunk: file.slice((part.partNumber - 1) * partSize, part.partNumber * partSize)\n            })),\n        fn: uploadPart,\n        maxParallel: 5,\n        maxRetries: 10\n    });\n    // Complete multipart upload\n    const res = await fetch(`${apiPath}/complete-multipart-upload`, {\n        method: 'POST',\n        body: JSON.stringify({\n            bucketName,\n            uploadId,\n            key,\n            parts: completedParts\n        }),\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    });\n    if (!res.ok) {\n        throw new EdgeStoreError('Multi-part upload failed');\n    }\n}\nasync function confirmUpload({ url }, { apiPath, bucketName }) {\n    const res = await fetch(`${apiPath}/confirm-upload`, {\n        method: 'POST',\n        body: JSON.stringify({\n            url,\n            bucketName\n        }),\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    });\n    if (!res.ok) {\n        throw new EdgeStoreError('An error occurred');\n    }\n    return res.json();\n}\nasync function deleteFile({ url }, { apiPath, bucketName }) {\n    const res = await fetch(`${apiPath}/delete-file`, {\n        method: 'POST',\n        body: JSON.stringify({\n            url,\n            bucketName\n        }),\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    });\n    if (!res.ok) {\n        throw new EdgeStoreError('An error occurred');\n    }\n    return res.json();\n}\nasync function queuedPromises({ items, fn, maxParallel, maxRetries = 0 }) {\n    const results = new Array(items.length);\n    const executeWithRetry = async (func, retries)=>{\n        try {\n            return await func();\n        } catch (error) {\n            if (retries > 0) {\n                await new Promise((resolve)=>setTimeout(resolve, 5000));\n                return executeWithRetry(func, retries - 1);\n            } else {\n                throw error;\n            }\n        }\n    };\n    const semaphore = {\n        count: maxParallel,\n        async wait () {\n            // If we've reached our maximum concurrency or it's the last item, wait\n            while(this.count <= 0)await new Promise((resolve)=>setTimeout(resolve, 500));\n            this.count--;\n        },\n        signal () {\n            this.count++;\n        }\n    };\n    const tasks = items.map((item, i)=>(async ()=>{\n            await semaphore.wait();\n            try {\n                const result = await executeWithRetry(()=>fn(item), maxRetries);\n                results[i] = result;\n            } finally{\n                semaphore.signal();\n            }\n        })());\n    await Promise.all(tasks);\n    return results;\n}\n\nconst DEFAULT_BASE_URL = process.env.NEXT_PUBLIC_EDGE_STORE_BASE_URL ?? 'https://files.edgestore.dev';\nfunction createEdgeStoreProvider(opts) {\n    const EdgeStoreContext = /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createContext(undefined);\n    const EdgeStoreProvider = ({ children, basePath })=>{\n        return EdgeStoreProviderInner({\n            children,\n            context: EdgeStoreContext,\n            basePath,\n            maxConcurrentUploads: opts?.maxConcurrentUploads\n        });\n    };\n    function useEdgeStore() {\n        if (!EdgeStoreContext) {\n            throw new Error('React Context is unavailable in Server Components');\n        }\n        // @ts-expect-error - We know that the context value should not be undefined\n        const value = react__WEBPACK_IMPORTED_MODULE_0__.useContext(EdgeStoreContext);\n        if (!value && \"development\" !== 'production') {\n            throw new Error('[edgestore]: `useEdgeStore` must be wrapped in a <EdgeStoreProvider />');\n        }\n        return value;\n    }\n    return {\n        EdgeStoreProvider,\n        useEdgeStore\n    };\n}\nfunction EdgeStoreProviderInner({ children, context, basePath, maxConcurrentUploads }) {\n    const apiPath = basePath ? `${basePath}` : '/api/edgestore';\n    const uploadingCountRef = react__WEBPACK_IMPORTED_MODULE_0__.useRef(0);\n    react__WEBPACK_IMPORTED_MODULE_0__.useEffect(()=>{\n        void init();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n    async function init() {\n        const res = await fetch(`${apiPath}/init`, {\n            method: 'POST'\n        });\n        if (res.ok) {\n            const json = await res.json();\n            await fetch(`${DEFAULT_BASE_URL}/_init`, {\n                method: 'GET',\n                headers: {\n                    'x-edgestore-token': json.token\n                }\n            });\n        }\n    }\n    async function reset() {\n        await init();\n    }\n    return /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/ react__WEBPACK_IMPORTED_MODULE_0__.createElement(context.Provider, {\n        value: {\n            edgestore: createNextProxy({\n                apiPath,\n                uploadingCountRef,\n                maxConcurrentUploads\n            }),\n            reset\n        }\n    }, children));\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9yZWFjdC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUErQjs7QUFFL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDJCQUEyQixzREFBc0Q7QUFDakYsdUJBQXVCO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0EsNEJBQTRCLFVBQVU7QUFDdEM7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQSw0QkFBNEIsVUFBVTtBQUN0QztBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsNEJBQTRCLHdDQUF3QyxJQUFJLHFCQUFxQjtBQUM3RjtBQUNBO0FBQ0EsbUNBQW1DLFFBQVE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLEtBQXNDO0FBQzlDO0FBQ0EsK0JBQStCLFFBQVE7QUFDdkM7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxZQUFZLDZEQUE2RDtBQUN6RSxZQUFZLDZDQUE2QztBQUN6RDtBQUNBO0FBQ0EsZ0JBQWdCLGNBQWM7QUFDOUIsZ0JBQWdCLFlBQVk7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjO0FBQ2Q7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSwrQkFBK0IsUUFBUTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLEtBQUssSUFBSSxxQkFBcUI7QUFDN0QsK0JBQStCLFFBQVE7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsS0FBSyxJQUFJLHFCQUFxQjtBQUMxRCwrQkFBK0IsUUFBUTtBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyx3Q0FBd0M7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsMkNBQTJDLGdEQUFtQjtBQUM5RCxpQ0FBaUMsb0JBQW9CO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDZDQUFnQjtBQUN0QyxzQkFBc0IsYUFBb0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLG1EQUFtRDtBQUNyRixrQ0FBa0MsU0FBUztBQUMzQyw4QkFBOEIseUNBQVk7QUFDMUMsSUFBSSw0Q0FBZTtBQUNuQjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0EsbUNBQW1DLFFBQVE7QUFDM0M7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLDJCQUEyQixpQkFBaUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixnREFBbUIsQ0FBQywyQ0FBYyxzQkFBc0IsZ0RBQW1CO0FBQ3BHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEtBQUs7QUFDTDs7QUFFbUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly96ZW5ib2FyZC8uL25vZGVfbW9kdWxlcy9AZWRnZXN0b3JlL3JlYWN0L2Rpc3QvaW5kZXgubWpzPzE5MGYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5jbGFzcyBFZGdlU3RvcmVFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlKXtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdFZGdlU3RvcmVFcnJvcic7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVOZXh0UHJveHkoeyBhcGlQYXRoLCB1cGxvYWRpbmdDb3VudFJlZiwgbWF4Q29uY3VycmVudFVwbG9hZHMgPSA1IH0pIHtcbiAgICByZXR1cm4gbmV3IFByb3h5KHt9LCB7XG4gICAgICAgIGdldCAoXywgcHJvcCkge1xuICAgICAgICAgICAgY29uc3QgYnVja2V0TmFtZSA9IHByb3A7XG4gICAgICAgICAgICBjb25zdCBidWNrZXRGdW5jdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgdXBsb2FkOiBhc3luYyAocGFyYW1zKT0+e1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zLm9uUHJvZ3Jlc3NDaGFuZ2U/LigwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlKHVwbG9hZGluZ0NvdW50UmVmLmN1cnJlbnQgPj0gbWF4Q29uY3VycmVudFVwbG9hZHMgJiYgdXBsb2FkaW5nQ291bnRSZWYuY3VycmVudCA+IDApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCAzMDApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGluZ0NvdW50UmVmLmN1cnJlbnQrKztcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB1cGxvYWRGaWxlKHBhcmFtcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWU6IGJ1Y2tldE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpUGF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZmluYWxseXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGluZ0NvdW50UmVmLmN1cnJlbnQtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29uZmlybVVwbG9hZDogYXN5bmMgKHBhcmFtcyk9PntcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBzdWNjZXNzIH0gPSBhd2FpdCBjb25maXJtVXBsb2FkKHBhcmFtcywge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnVja2V0TmFtZTogYnVja2V0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaVBhdGhcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVkZ2VTdG9yZUVycm9yKCdGYWlsZWQgdG8gY29uZmlybSB1cGxvYWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZGVsZXRlOiBhc3luYyAocGFyYW1zKT0+e1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IHN1Y2Nlc3MgfSA9IGF3YWl0IGRlbGV0ZUZpbGUocGFyYW1zLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBidWNrZXROYW1lOiBidWNrZXROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXBpUGF0aFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWNjZXNzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRWRnZVN0b3JlRXJyb3IoJ0ZhaWxlZCB0byBkZWxldGUgZmlsZScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBidWNrZXRGdW5jdGlvbnM7XG4gICAgICAgIH1cbiAgICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHVwbG9hZEZpbGUoeyBmaWxlLCBpbnB1dCwgb25Qcm9ncmVzc0NoYW5nZSwgb3B0aW9ucyB9LCB7IGFwaVBhdGgsIGJ1Y2tldE5hbWUgfSkge1xuICAgIHRyeSB7XG4gICAgICAgIG9uUHJvZ3Jlc3NDaGFuZ2U/LigwKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YXBpUGF0aH0vcmVxdWVzdC11cGxvYWRgLCB7XG4gICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBidWNrZXROYW1lLFxuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgIGZpbGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvbjogZmlsZS5uYW1lLnNwbGl0KCcuJykucG9wKCksXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGZpbGUudHlwZSxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogZmlsZS5zaXplLFxuICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZTogb3B0aW9ucz8ubWFudWFsRmlsZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VUYXJnZXRVcmw6IG9wdGlvbnM/LnJlcGxhY2VUYXJnZXRVcmwsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBvcmFyeTogb3B0aW9ucz8udGVtcG9yYXJ5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QganNvbiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgIGlmICgnbXVsdGlwYXJ0JyBpbiBqc29uKSB7XG4gICAgICAgICAgICBhd2FpdCBtdWx0aXBhcnRVcGxvYWQoe1xuICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWUsXG4gICAgICAgICAgICAgICAgbXVsdGlwYXJ0SW5mbzoganNvbi5tdWx0aXBhcnQsXG4gICAgICAgICAgICAgICAgb25Qcm9ncmVzc0NoYW5nZSxcbiAgICAgICAgICAgICAgICBmaWxlLFxuICAgICAgICAgICAgICAgIGFwaVBhdGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKCd1cGxvYWRVcmwnIGluIGpzb24pIHtcbiAgICAgICAgICAgIC8vIFNpbmdsZSBwYXJ0IHVwbG9hZFxuICAgICAgICAgICAgLy8gVXBsb2FkIHRoZSBmaWxlIHRvIHRoZSBzaWduZWQgVVJMIGFuZCBnZXQgdGhlIHByb2dyZXNzXG4gICAgICAgICAgICBhd2FpdCB1cGxvYWRGaWxlSW5uZXIoZmlsZSwganNvbi51cGxvYWRVcmwsIG9uUHJvZ3Jlc3NDaGFuZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVkZ2VTdG9yZUVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cmw6IGdldFVybChqc29uLmFjY2Vzc1VybCwgYXBpUGF0aCksXG4gICAgICAgICAgICB0aHVtYm5haWxVcmw6IGpzb24udGh1bWJuYWlsVXJsID8gZ2V0VXJsKGpzb24udGh1bWJuYWlsVXJsLCBhcGlQYXRoKSA6IG51bGwsXG4gICAgICAgICAgICBzaXplOiBqc29uLnNpemUsXG4gICAgICAgICAgICB1cGxvYWRlZEF0OiBuZXcgRGF0ZShqc29uLnVwbG9hZGVkQXQpLFxuICAgICAgICAgICAgcGF0aDoganNvbi5wYXRoLFxuICAgICAgICAgICAgcGF0aE9yZGVyOiBqc29uLnBhdGhPcmRlcixcbiAgICAgICAgICAgIG1ldGFkYXRhOiBqc29uLm1ldGFkYXRhXG4gICAgICAgIH07XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBvblByb2dyZXNzQ2hhbmdlPy4oMCk7XG4gICAgICAgIHRocm93IGU7XG4gICAgfVxufVxuLyoqXG4gKiBQcm90ZWN0ZWQgZmlsZXMgbmVlZCB0aGlyZC1wYXJ0eSBjb29raWVzIHRvIHdvcmsuXG4gKiBTaW5jZSB0aGlyZCBwYXJ0eSBjb29raWVzIGRvZXNuJ3Qgd29yayBvbiBsb2NhbGhvc3QsXG4gKiB3ZSBuZWVkIHRvIHByb3h5IHRoZSBmaWxlIHRocm91Z2ggdGhlIHNlcnZlci5cbiAqLyBmdW5jdGlvbiBnZXRVcmwodXJsLCBhcGlQYXRoKSB7XG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnICYmICF1cmwuaW5jbHVkZXMoJy9fcHVibGljLycpKSB7XG4gICAgICAgIGNvbnN0IHByb3h5VXJsID0gbmV3IFVSTCh3aW5kb3cubG9jYXRpb24ub3JpZ2luKTtcbiAgICAgICAgcHJveHlVcmwucGF0aG5hbWUgPSBgJHthcGlQYXRofS9wcm94eS1maWxlYDtcbiAgICAgICAgcHJveHlVcmwuc2VhcmNoID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgICAgICB1cmxcbiAgICAgICAgfSkudG9TdHJpbmcoKTtcbiAgICAgICAgcmV0dXJuIHByb3h5VXJsLnRvU3RyaW5nKCk7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG59XG5jb25zdCB1cGxvYWRGaWxlSW5uZXIgPSBhc3luYyAoZmlsZSwgdXBsb2FkVXJsLCBvblByb2dyZXNzQ2hhbmdlKT0+e1xuICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KT0+e1xuICAgICAgICBjb25zdCByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHJlcXVlc3Qub3BlbignUFVUJywgdXBsb2FkVXJsKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2Fkc3RhcnQnLCAoKT0+e1xuICAgICAgICAgICAgb25Qcm9ncmVzc0NoYW5nZT8uKDApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCAoZSk9PntcbiAgICAgICAgICAgIGlmIChlLmxlbmd0aENvbXB1dGFibGUpIHtcbiAgICAgICAgICAgICAgICAvLyAyIGRlY2ltYWwgcHJvZ3Jlc3NcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9ncmVzcyA9IE1hdGgucm91bmQoZS5sb2FkZWQgLyBlLnRvdGFsICogMTAwMDApIC8gMTAwO1xuICAgICAgICAgICAgICAgIG9uUHJvZ3Jlc3NDaGFuZ2U/Lihwcm9ncmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgKCk9PntcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ0Vycm9yIHVwbG9hZGluZyBmaWxlJykpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsICgpPT57XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdGaWxlIHVwbG9hZCBhYm9ydGVkJykpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZW5kJywgKCk9PntcbiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgRVRhZyBoZWFkZXIgKG5lZWRlZCB0byBjb21wbGV0ZSBtdWx0aXBhcnQgdXBsb2FkKVxuICAgICAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKCdFVGFnJykpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmVxdWVzdC5zZW5kKGZpbGUpO1xuICAgIH0pO1xuICAgIHJldHVybiBwcm9taXNlO1xufTtcbmFzeW5jIGZ1bmN0aW9uIG11bHRpcGFydFVwbG9hZChwYXJhbXMpIHtcbiAgICBjb25zdCB7IGJ1Y2tldE5hbWUsIG11bHRpcGFydEluZm8sIG9uUHJvZ3Jlc3NDaGFuZ2UsIGZpbGUsIGFwaVBhdGggfSA9IHBhcmFtcztcbiAgICBjb25zdCB7IHBhcnRTaXplLCBwYXJ0cywgdG90YWxQYXJ0cywgdXBsb2FkSWQsIGtleSB9ID0gbXVsdGlwYXJ0SW5mbztcbiAgICBjb25zdCB1cGxvYWRpbmdQYXJ0cyA9IFtdO1xuICAgIGNvbnN0IHVwbG9hZFBhcnQgPSBhc3luYyAocGFyYW1zKT0+e1xuICAgICAgICBjb25zdCB7IHBhcnQsIGNodW5rIH0gPSBwYXJhbXM7XG4gICAgICAgIGNvbnN0IHsgdXBsb2FkVXJsIH0gPSBwYXJ0O1xuICAgICAgICBjb25zdCBlVGFnID0gYXdhaXQgdXBsb2FkRmlsZUlubmVyKGNodW5rLCB1cGxvYWRVcmwsIChwcm9ncmVzcyk9PntcbiAgICAgICAgICAgIGNvbnN0IHVwbG9hZGluZ1BhcnQgPSB1cGxvYWRpbmdQYXJ0cy5maW5kKChwKT0+cC5wYXJ0TnVtYmVyID09PSBwYXJ0LnBhcnROdW1iZXIpO1xuICAgICAgICAgICAgaWYgKHVwbG9hZGluZ1BhcnQpIHtcbiAgICAgICAgICAgICAgICB1cGxvYWRpbmdQYXJ0LnByb2dyZXNzID0gcHJvZ3Jlc3M7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHVwbG9hZGluZ1BhcnRzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBwYXJ0TnVtYmVyOiBwYXJ0LnBhcnROdW1iZXIsXG4gICAgICAgICAgICAgICAgICAgIHByb2dyZXNzXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB0b3RhbFByb2dyZXNzID0gTWF0aC5yb3VuZCh1cGxvYWRpbmdQYXJ0cy5yZWR1Y2UoKGFjYywgcCk9PmFjYyArIHAucHJvZ3Jlc3MgKiAxMDAsIDApIC8gdG90YWxQYXJ0cykgLyAxMDA7XG4gICAgICAgICAgICBvblByb2dyZXNzQ2hhbmdlPy4odG90YWxQcm9ncmVzcyk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWVUYWcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcignQ291bGQgbm90IGdldCBFVGFnIGZyb20gbXVsdGlwYXJ0IHJlc3BvbnNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHBhcnROdW1iZXI6IHBhcnQucGFydE51bWJlcixcbiAgICAgICAgICAgIGVUYWdcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8vIFVwbG9hZCB0aGUgcGFydHMgaW4gcGFyYWxsZWxcbiAgICBjb25zdCBjb21wbGV0ZWRQYXJ0cyA9IGF3YWl0IHF1ZXVlZFByb21pc2VzKHtcbiAgICAgICAgaXRlbXM6IHBhcnRzLm1hcCgocGFydCk9Pih7XG4gICAgICAgICAgICAgICAgcGFydCxcbiAgICAgICAgICAgICAgICBjaHVuazogZmlsZS5zbGljZSgocGFydC5wYXJ0TnVtYmVyIC0gMSkgKiBwYXJ0U2l6ZSwgcGFydC5wYXJ0TnVtYmVyICogcGFydFNpemUpXG4gICAgICAgICAgICB9KSksXG4gICAgICAgIGZuOiB1cGxvYWRQYXJ0LFxuICAgICAgICBtYXhQYXJhbGxlbDogNSxcbiAgICAgICAgbWF4UmV0cmllczogMTBcbiAgICB9KTtcbiAgICAvLyBDb21wbGV0ZSBtdWx0aXBhcnQgdXBsb2FkXG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YXBpUGF0aH0vY29tcGxldGUtbXVsdGlwYXJ0LXVwbG9hZGAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGJ1Y2tldE5hbWUsXG4gICAgICAgICAgICB1cGxvYWRJZCxcbiAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgIHBhcnRzOiBjb21wbGV0ZWRQYXJ0c1xuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVkZ2VTdG9yZUVycm9yKCdNdWx0aS1wYXJ0IHVwbG9hZCBmYWlsZWQnKTtcbiAgICB9XG59XG5hc3luYyBmdW5jdGlvbiBjb25maXJtVXBsb2FkKHsgdXJsIH0sIHsgYXBpUGF0aCwgYnVja2V0TmFtZSB9KSB7XG4gICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goYCR7YXBpUGF0aH0vY29uZmlybS11cGxvYWRgLCB7XG4gICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICB1cmwsXG4gICAgICAgICAgICBidWNrZXROYW1lXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoIXJlcy5vaykge1xuICAgICAgICB0aHJvdyBuZXcgRWRnZVN0b3JlRXJyb3IoJ0FuIGVycm9yIG9jY3VycmVkJyk7XG4gICAgfVxuICAgIHJldHVybiByZXMuanNvbigpO1xufVxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlRmlsZSh7IHVybCB9LCB7IGFwaVBhdGgsIGJ1Y2tldE5hbWUgfSkge1xuICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKGAke2FwaVBhdGh9L2RlbGV0ZS1maWxlYCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgYnVja2V0TmFtZVxuICAgICAgICB9KSxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVkZ2VTdG9yZUVycm9yKCdBbiBlcnJvciBvY2N1cnJlZCcpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzLmpzb24oKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHF1ZXVlZFByb21pc2VzKHsgaXRlbXMsIGZuLCBtYXhQYXJhbGxlbCwgbWF4UmV0cmllcyA9IDAgfSkge1xuICAgIGNvbnN0IHJlc3VsdHMgPSBuZXcgQXJyYXkoaXRlbXMubGVuZ3RoKTtcbiAgICBjb25zdCBleGVjdXRlV2l0aFJldHJ5ID0gYXN5bmMgKGZ1bmMsIHJldHJpZXMpPT57XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZnVuYygpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKHJldHJpZXMgPiAwKSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpPT5zZXRUaW1lb3V0KHJlc29sdmUsIDUwMDApKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhlY3V0ZVdpdGhSZXRyeShmdW5jLCByZXRyaWVzIC0gMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBjb25zdCBzZW1hcGhvcmUgPSB7XG4gICAgICAgIGNvdW50OiBtYXhQYXJhbGxlbCxcbiAgICAgICAgYXN5bmMgd2FpdCAoKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSd2ZSByZWFjaGVkIG91ciBtYXhpbXVtIGNvbmN1cnJlbmN5IG9yIGl0J3MgdGhlIGxhc3QgaXRlbSwgd2FpdFxuICAgICAgICAgICAgd2hpbGUodGhpcy5jb3VudCA8PSAwKWF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKT0+c2V0VGltZW91dChyZXNvbHZlLCA1MDApKTtcbiAgICAgICAgICAgIHRoaXMuY291bnQtLTtcbiAgICAgICAgfSxcbiAgICAgICAgc2lnbmFsICgpIHtcbiAgICAgICAgICAgIHRoaXMuY291bnQrKztcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3QgdGFza3MgPSBpdGVtcy5tYXAoKGl0ZW0sIGkpPT4oYXN5bmMgKCk9PntcbiAgICAgICAgICAgIGF3YWl0IHNlbWFwaG9yZS53YWl0KCk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGV4ZWN1dGVXaXRoUmV0cnkoKCk9PmZuKGl0ZW0pLCBtYXhSZXRyaWVzKTtcbiAgICAgICAgICAgICAgICByZXN1bHRzW2ldID0gcmVzdWx0O1xuICAgICAgICAgICAgfSBmaW5hbGx5e1xuICAgICAgICAgICAgICAgIHNlbWFwaG9yZS5zaWduYWwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkoKSk7XG4gICAgYXdhaXQgUHJvbWlzZS5hbGwodGFza3MpO1xuICAgIHJldHVybiByZXN1bHRzO1xufVxuXG5jb25zdCBERUZBVUxUX0JBU0VfVVJMID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRURHRV9TVE9SRV9CQVNFX1VSTCA/PyAnaHR0cHM6Ly9maWxlcy5lZGdlc3RvcmUuZGV2JztcbmZ1bmN0aW9uIGNyZWF0ZUVkZ2VTdG9yZVByb3ZpZGVyKG9wdHMpIHtcbiAgICBjb25zdCBFZGdlU3RvcmVDb250ZXh0ID0gLyojX19QVVJFX18qLyBSZWFjdC5jcmVhdGVDb250ZXh0KHVuZGVmaW5lZCk7XG4gICAgY29uc3QgRWRnZVN0b3JlUHJvdmlkZXIgPSAoeyBjaGlsZHJlbiwgYmFzZVBhdGggfSk9PntcbiAgICAgICAgcmV0dXJuIEVkZ2VTdG9yZVByb3ZpZGVySW5uZXIoe1xuICAgICAgICAgICAgY2hpbGRyZW4sXG4gICAgICAgICAgICBjb250ZXh0OiBFZGdlU3RvcmVDb250ZXh0LFxuICAgICAgICAgICAgYmFzZVBhdGgsXG4gICAgICAgICAgICBtYXhDb25jdXJyZW50VXBsb2Fkczogb3B0cz8ubWF4Q29uY3VycmVudFVwbG9hZHNcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBmdW5jdGlvbiB1c2VFZGdlU3RvcmUoKSB7XG4gICAgICAgIGlmICghRWRnZVN0b3JlQ29udGV4dCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdSZWFjdCBDb250ZXh0IGlzIHVuYXZhaWxhYmxlIGluIFNlcnZlciBDb21wb25lbnRzJyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvciAtIFdlIGtub3cgdGhhdCB0aGUgY29udGV4dCB2YWx1ZSBzaG91bGQgbm90IGJlIHVuZGVmaW5lZFxuICAgICAgICBjb25zdCB2YWx1ZSA9IFJlYWN0LnVzZUNvbnRleHQoRWRnZVN0b3JlQ29udGV4dCk7XG4gICAgICAgIGlmICghdmFsdWUgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdbZWRnZXN0b3JlXTogYHVzZUVkZ2VTdG9yZWAgbXVzdCBiZSB3cmFwcGVkIGluIGEgPEVkZ2VTdG9yZVByb3ZpZGVyIC8+Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBFZGdlU3RvcmVQcm92aWRlcixcbiAgICAgICAgdXNlRWRnZVN0b3JlXG4gICAgfTtcbn1cbmZ1bmN0aW9uIEVkZ2VTdG9yZVByb3ZpZGVySW5uZXIoeyBjaGlsZHJlbiwgY29udGV4dCwgYmFzZVBhdGgsIG1heENvbmN1cnJlbnRVcGxvYWRzIH0pIHtcbiAgICBjb25zdCBhcGlQYXRoID0gYmFzZVBhdGggPyBgJHtiYXNlUGF0aH1gIDogJy9hcGkvZWRnZXN0b3JlJztcbiAgICBjb25zdCB1cGxvYWRpbmdDb3VudFJlZiA9IFJlYWN0LnVzZVJlZigwKTtcbiAgICBSZWFjdC51c2VFZmZlY3QoKCk9PntcbiAgICAgICAgdm9pZCBpbml0KCk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICAgIH0sIFtdKTtcbiAgICBhc3luYyBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHthcGlQYXRofS9pbml0YCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCdcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgYXdhaXQgZmV0Y2goYCR7REVGQVVMVF9CQVNFX1VSTH0vX2luaXRgLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICd4LWVkZ2VzdG9yZS10b2tlbic6IGpzb24udG9rZW5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgYXdhaXQgaW5pdCgpO1xuICAgIH1cbiAgICByZXR1cm4gLyojX19QVVJFX18qLyBSZWFjdC5jcmVhdGVFbGVtZW50KFJlYWN0LkZyYWdtZW50LCBudWxsLCAvKiNfX1BVUkVfXyovIFJlYWN0LmNyZWF0ZUVsZW1lbnQoY29udGV4dC5Qcm92aWRlciwge1xuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgZWRnZXN0b3JlOiBjcmVhdGVOZXh0UHJveHkoe1xuICAgICAgICAgICAgICAgIGFwaVBhdGgsXG4gICAgICAgICAgICAgICAgdXBsb2FkaW5nQ291bnRSZWYsXG4gICAgICAgICAgICAgICAgbWF4Q29uY3VycmVudFVwbG9hZHNcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgcmVzZXRcbiAgICAgICAgfVxuICAgIH0sIGNoaWxkcmVuKSk7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZUVkZ2VTdG9yZVByb3ZpZGVyIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@edgestore/react/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@edgestore/server/dist/adapters/next/app/index.mjs":
/*!*************************************************************************!*\
  !*** ./node_modules/@edgestore/server/dist/adapters/next/app/index.mjs ***!
  \*************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createEdgeStoreNextHandler: () => (/* binding */ createEdgeStoreNextHandler)\n/* harmony export */ });\n/* harmony import */ var _shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../shared-6dea9e91.mjs */ \"(rsc)/./node_modules/@edgestore/server/dist/shared-6dea9e91.mjs\");\n/* harmony import */ var _providers_edgestore_index_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../providers/edgestore/index.mjs */ \"(rsc)/./node_modules/@edgestore/server/dist/providers/edgestore/index.mjs\");\n/* harmony import */ var _panva_hkdf__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @panva/hkdf */ \"(rsc)/./node_modules/@panva/hkdf/dist/node/esm/index.js\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! cookie */ \"(rsc)/./node_modules/cookie/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/index.js\");\n/* harmony import */ var _index_30a3741e_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../index-30a3741e.mjs */ \"(rsc)/./node_modules/@edgestore/server/dist/index-30a3741e.mjs\");\n\n\n\n\n\n\n\n\nfunction createEdgeStoreNextHandler(config) {\n    const { provider = (0,_providers_edgestore_index_mjs__WEBPACK_IMPORTED_MODULE_1__.EdgeStoreProvider)() } = config;\n    return async (req)=>{\n        try {\n            if (req.nextUrl.pathname === \"/api/edgestore/init\") {\n                const ctx = \"createContext\" in config ? await config.createContext({\n                    req\n                }) : {};\n                const { newCookies, token, baseUrl } = await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.i)({\n                    ctx,\n                    provider,\n                    router: config.router\n                });\n                const res = new Response(JSON.stringify({\n                    token,\n                    baseUrl\n                }), {\n                    status: 200,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n                for (const cookie of newCookies){\n                    res.headers.append(\"Set-Cookie\", cookie);\n                }\n                return res;\n            } else if (req.nextUrl.pathname === \"/api/edgestore/request-upload\") {\n                const res = await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.r)({\n                    provider,\n                    router: config.router,\n                    body: await req.json(),\n                    ctxToken: req.cookies.get(\"edgestore-ctx\")?.value\n                });\n                return new Response(JSON.stringify(res), {\n                    status: 200,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            } else if (req.nextUrl.pathname === \"/api/edgestore/request-upload-parts\") {\n                const res = await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.a)({\n                    provider,\n                    router: config.router,\n                    body: await req.json(),\n                    ctxToken: req.cookies.get(\"edgestore-ctx\")?.value\n                });\n                return new Response(JSON.stringify(res), {\n                    status: 200,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            } else if (req.nextUrl.pathname === \"/api/edgestore/complete-multipart-upload\") {\n                await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.c)({\n                    provider,\n                    router: config.router,\n                    body: await req.json(),\n                    ctxToken: req.cookies.get(\"edgestore-ctx\")?.value\n                });\n                return new Response(null, {\n                    status: 200\n                });\n            } else if (req.nextUrl.pathname === \"/api/edgestore/confirm-upload\") {\n                const res = await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.b)({\n                    provider,\n                    router: config.router,\n                    body: await req.json(),\n                    ctxToken: req.cookies.get(\"edgestore-ctx\")?.value\n                });\n                return new Response(JSON.stringify(res), {\n                    status: 200,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            } else if (req.nextUrl.pathname === \"/api/edgestore/delete-file\") {\n                const res = await (0,_shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.d)({\n                    provider,\n                    router: config.router,\n                    body: await req.json(),\n                    ctxToken: req.cookies.get(\"edgestore-ctx\")?.value\n                });\n                return new Response(JSON.stringify(res), {\n                    status: 200,\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    }\n                });\n            } else if (req.nextUrl.pathname === \"/api/edgestore/proxy-file\") {\n                const url = req.nextUrl.searchParams.get(\"url\");\n                if (typeof url === \"string\") {\n                    const proxyRes = await fetch(url, {\n                        headers: {\n                            cookie: req.cookies.toString() ?? \"\"\n                        }\n                    });\n                    const data = await proxyRes.arrayBuffer();\n                    return new Response(data, {\n                        status: proxyRes.status,\n                        headers: {\n                            \"Content-Type\": proxyRes.headers.get(\"Content-Type\") ?? \"application/octet-stream\"\n                        }\n                    });\n                } else {\n                    return new Response(null, {\n                        status: 400\n                    });\n                }\n            } else {\n                return new Response(null, {\n                    status: 404\n                });\n            }\n        } catch (err) {\n            if (err instanceof _shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.E) {\n                return new Response(err.message, {\n                    status: _shared_6dea9e91_mjs__WEBPACK_IMPORTED_MODULE_0__.e[err.code]\n                });\n            } else if (err instanceof Error) {\n                return new Response(err.message, {\n                    status: 500\n                });\n            }\n            return new Response(\"Internal server error\", {\n                status: 500\n            });\n        }\n    };\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9hZGFwdGVycy9uZXh0L2FwcC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUEyTjtBQUNoSjtBQUN0RDtBQUNMO0FBQ0Y7QUFDQTtBQUMyQjtBQUNKO0FBRXJDLFNBQVNpQiwyQkFBMkJDLE1BQU07SUFDdEMsTUFBTSxFQUFFQyxXQUFXSCxpRkFBaUJBLEVBQUUsRUFBRSxHQUFHRTtJQUMzQyxPQUFPLE9BQU9FO1FBQ1YsSUFBSTtZQUNBLElBQUlBLElBQUlDLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLLHVCQUF1QjtnQkFDaEQsTUFBTUMsTUFBTSxtQkFBbUJMLFNBQVMsTUFBTUEsT0FBT00sYUFBYSxDQUFDO29CQUMvREo7Z0JBQ0osS0FBSyxDQUFDO2dCQUNOLE1BQU0sRUFBRUssVUFBVSxFQUFFQyxLQUFLLEVBQUVDLE9BQU8sRUFBRSxHQUFHLE1BQU0xQix1REFBSUEsQ0FBQztvQkFDOUNzQjtvQkFDQUo7b0JBQ0FTLFFBQVFWLE9BQU9VLE1BQU07Z0JBQ3pCO2dCQUNBLE1BQU1DLE1BQU0sSUFBSUMsU0FBU0MsS0FBS0MsU0FBUyxDQUFDO29CQUNwQ047b0JBQ0FDO2dCQUNKLElBQUk7b0JBQ0FNLFFBQVE7b0JBQ1JDLFNBQVM7d0JBQ0wsZ0JBQWdCO29CQUNwQjtnQkFDSjtnQkFDQSxLQUFLLE1BQU1DLFVBQVVWLFdBQVc7b0JBQzVCSSxJQUFJSyxPQUFPLENBQUNFLE1BQU0sQ0FBQyxjQUFjRDtnQkFDckM7Z0JBQ0EsT0FBT047WUFDWCxPQUFPLElBQUlULElBQUlDLE9BQU8sQ0FBQ0MsUUFBUSxLQUFLLGlDQUFpQztnQkFDakUsTUFBTU8sTUFBTSxNQUFNMUIsdURBQWFBLENBQUM7b0JBQzVCZ0I7b0JBQ0FTLFFBQVFWLE9BQU9VLE1BQU07b0JBQ3JCUyxNQUFNLE1BQU1qQixJQUFJa0IsSUFBSTtvQkFDcEJDLFVBQVVuQixJQUFJb0IsT0FBTyxDQUFDQyxHQUFH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WUFDSjtRQUNKLEVBQUUsT0FBT2lCLEtBQUs7WUFDVixJQUFJQSxlQUFlckMsbURBQWNBLEVBQUU7Z0JBQy9CLE9BQU8sSUFBSWlCLFNBQVNvQixJQUFJQyxPQUFPLEVBQUU7b0JBQzdCbEIsUUFBUWxCLG1EQUFzQixDQUFDbUMsSUFBSUUsSUFBSSxDQUFDO2dCQUM1QztZQUNKLE9BQU8sSUFBSUYsZUFBZUcsT0FBTztnQkFDN0IsT0FBTyxJQUFJdkIsU0FBU29CLElBQUlDLE9BQU8sRUFBRTtvQkFDN0JsQixRQUFRO2dCQUNaO1lBQ0o7WUFDQSxPQUFPLElBQUlILFNBQVMseUJBQXlCO2dCQUN6Q0csUUFBUTtZQUNaO1FBQ0o7SUFDSjtBQUNKO0FBRXNDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vemVuYm9hcmQvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9hZGFwdGVycy9uZXh0L2FwcC9pbmRleC5tanM/Nzc0NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpIGFzIGluaXQsIHIgYXMgcmVxdWVzdFVwbG9hZCwgYSBhcyByZXF1ZXN0VXBsb2FkUGFydHMsIGMgYXMgY29tcGxldGVNdWx0aXBhcnRVcGxvYWQsIGIgYXMgY29uZmlybVVwbG9hZCwgZCBhcyBkZWxldGVGaWxlLCBFIGFzIEVkZ2VTdG9yZUVycm9yLCBlIGFzIEVER0VfU1RPUkVfRVJST1JfQ09ERVMgfSBmcm9tICcuLi8uLi8uLi9zaGFyZWQtNmRlYTllOTEubWpzJztcbmltcG9ydCB7IEVkZ2VTdG9yZVByb3ZpZGVyIH0gZnJvbSAnLi4vLi4vLi4vcHJvdmlkZXJzL2VkZ2VzdG9yZS9pbmRleC5tanMnO1xuaW1wb3J0ICdAcGFudmEvaGtkZic7XG5pbXBvcnQgJ2Nvb2tpZSc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICd1dWlkJztcbmltcG9ydCAnQHN3Yy9oZWxwZXJzL18vX2RlZmluZV9wcm9wZXJ0eSc7XG5pbXBvcnQgJy4uLy4uLy4uL2luZGV4LTMwYTM3NDFlLm1qcyc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUVkZ2VTdG9yZU5leHRIYW5kbGVyKGNvbmZpZykge1xuICAgIGNvbnN0IHsgcHJvdmlkZXIgPSBFZGdlU3RvcmVQcm92aWRlcigpIH0gPSBjb25maWc7XG4gICAgcmV0dXJuIGFzeW5jIChyZXEpPT57XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUgPT09ICcvYXBpL2VkZ2VzdG9yZS9pbml0Jykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9ICdjcmVhdGVDb250ZXh0JyBpbiBjb25maWcgPyBhd2FpdCBjb25maWcuY3JlYXRlQ29udGV4dCh7XG4gICAgICAgICAgICAgICAgICAgIHJlcVxuICAgICAgICAgICAgICAgIH0pIDoge307XG4gICAgICAgICAgICAgICAgY29uc3QgeyBuZXdDb29raWVzLCB0b2tlbiwgYmFzZVVybCB9ID0gYXdhaXQgaW5pdCh7XG4gICAgICAgICAgICAgICAgICAgIGN0eCxcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlcjogY29uZmlnLnJvdXRlclxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuLFxuICAgICAgICAgICAgICAgICAgICBiYXNlVXJsXG4gICAgICAgICAgICAgICAgfSksIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29va2llIG9mIG5ld0Nvb2tpZXMpe1xuICAgICAgICAgICAgICAgICAgICByZXMuaGVhZGVycy5hcHBlbmQoJ1NldC1Db29raWUnLCBjb29raWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXEubmV4dFVybC5wYXRobmFtZSA9PT0gJy9hcGkvZWRnZXN0b3JlL3JlcXVlc3QtdXBsb2FkJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RVcGxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgcm91dGVyOiBjb25maWcucm91dGVyLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBhd2FpdCByZXEuanNvbigpLFxuICAgICAgICAgICAgICAgICAgICBjdHhUb2tlbjogcmVxLmNvb2tpZXMuZ2V0KCdlZGdlc3RvcmUtY3R4Jyk/LnZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShyZXMpLCB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUgPT09ICcvYXBpL2VkZ2VzdG9yZS9yZXF1ZXN0LXVwbG9hZC1wYXJ0cycpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0VXBsb2FkUGFydHMoe1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgcm91dGVyOiBjb25maWcucm91dGVyLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBhd2FpdCByZXEuanNvbigpLFxuICAgICAgICAgICAgICAgICAgICBjdHhUb2tlbjogcmVxLmNvb2tpZXMuZ2V0KCdlZGdlc3RvcmUtY3R4Jyk/LnZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShyZXMpLCB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUgPT09ICcvYXBpL2VkZ2VzdG9yZS9jb21wbGV0ZS1tdWx0aXBhcnQtdXBsb2FkJykge1xuICAgICAgICAgICAgICAgIGF3YWl0IGNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlcjogY29uZmlnLnJvdXRlcixcbiAgICAgICAgICAgICAgICAgICAgYm9keTogYXdhaXQgcmVxLmpzb24oKSxcbiAgICAgICAgICAgICAgICAgICAgY3R4VG9rZW46IHJlcS5jb29raWVzLmdldCgnZWRnZXN0b3JlLWN0eCcpPy52YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDIwMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyZXEubmV4dFVybC5wYXRobmFtZSA9PT0gJy9hcGkvZWRnZXN0b3JlL2NvbmZpcm0tdXBsb2FkJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGNvbmZpcm1VcGxvYWQoe1xuICAgICAgICAgICAgICAgICAgICBwcm92aWRlcixcbiAgICAgICAgICAgICAgICAgICAgcm91dGVyOiBjb25maWcucm91dGVyLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiBhd2FpdCByZXEuanNvbigpLFxuICAgICAgICAgICAgICAgICAgICBjdHhUb2tlbjogcmVxLmNvb2tpZXMuZ2V0KCdlZGdlc3RvcmUtY3R4Jyk/LnZhbHVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeShyZXMpLCB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogMjAwLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVxLm5leHRVcmwucGF0aG5hbWUgPT09ICcvYXBpL2VkZ2VzdG9yZS9kZWxldGUtZmlsZScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkZWxldGVGaWxlKHtcbiAgICAgICAgICAgICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgICAgICAgICAgIHJvdXRlcjogY29uZmlnLnJvdXRlcixcbiAgICAgICAgICAgICAgICAgICAgYm9keTogYXdhaXQgcmVxLmpzb24oKSxcbiAgICAgICAgICAgICAgICAgICAgY3R4VG9rZW46IHJlcS5jb29raWVzLmdldCgnZWRnZXN0b3JlLWN0eCcpPy52YWx1ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoSlNPTi5zdHJpbmdpZnkocmVzKSwge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcS5uZXh0VXJsLnBhdGhuYW1lID09PSAnL2FwaS9lZGdlc3RvcmUvcHJveHktZmlsZScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSByZXEubmV4dFVybC5zZWFyY2hQYXJhbXMuZ2V0KCd1cmwnKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHVybCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJveHlSZXMgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb29raWU6IHJlcS5jb29raWVzLnRvU3RyaW5nKCkgPz8gJydcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBwcm94eVJlcy5hcnJheUJ1ZmZlcigpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGRhdGEsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogcHJveHlSZXMuc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiBwcm94eVJlcy5oZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJykgPz8gJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShudWxsLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDQwMFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UobnVsbCwge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IDQwNFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGlmIChlcnIgaW5zdGFuY2VvZiBFZGdlU3RvcmVFcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoZXJyLm1lc3NhZ2UsIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBFREdFX1NUT1JFX0VSUk9SX0NPREVTW2Vyci5jb2RlXVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoZXJyLm1lc3NhZ2UsIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiA1MDBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UoJ0ludGVybmFsIHNlcnZlciBlcnJvcicsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBjcmVhdGVFZGdlU3RvcmVOZXh0SGFuZGxlciB9O1xuIl0sIm5hbWVzIjpbImkiLCJpbml0IiwiciIsInJlcXVlc3RVcGxvYWQiLCJhIiwicmVxdWVzdFVwbG9hZFBhcnRzIiwiYyIsImNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkIiwiYiIsImNvbmZpcm1VcGxvYWQiLCJkIiwiZGVsZXRlRmlsZSIsIkUiLCJFZGdlU3RvcmVFcnJvciIsImUiLCJFREdFX1NUT1JFX0VSUk9SX0NPREVTIiwiRWRnZVN0b3JlUHJvdmlkZXIiLCJjcmVhdGVFZGdlU3RvcmVOZXh0SGFuZGxlciIsImNvbmZpZyIsInByb3ZpZGVyIiwicmVxIiwibmV4dFVybCIsInBhdGhuYW1lIiwiY3R4IiwiY3JlYXRlQ29udGV4dCIsIm5ld0Nvb2tpZXMiLCJ0b2tlbiIsImJhc2VVcmwiLCJyb3V0ZXIiLCJyZXMiLCJSZXNwb25zZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJzdGF0dXMiLCJoZWFkZXJzIiwiY29va2llIiwiYXBwZW5kIiwiYm9keSIsImpzb24iLCJjdHhUb2tlbiIsImNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsInVybCIsInNlYXJjaFBhcmFtcyIsInByb3h5UmVzIiwiZmV0Y2giLCJ0b1N0cmluZyIsImRhdGEiLCJhcnJheUJ1ZmZlciIsImVyciIsIm1lc3NhZ2UiLCJjb2RlIiwiRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@edgestore/server/dist/adapters/next/app/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@edgestore/server/dist/index-30a3741e.mjs":
/*!****************************************************************!*\
  !*** ./node_modules/@edgestore/server/dist/index-30a3741e.mjs ***!
  \****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: () => (/* binding */ EdgeStoreCredentialsError),\n/* harmony export */   e: () => (/* binding */ edgeStoreRawSdk),\n/* harmony export */   i: () => (/* binding */ initEdgeStoreSdk)\n/* harmony export */ });\nconst DEFAULT_MESSAGE = `Missing EDGE_STORE_ACCESS_KEY or EDGE_STORE_SECRET_KEY. \nThis can happen if you are trying to use the vanilla client in your frontend.\nThe vanilla client should only be used in the backend.`;\nclass EdgeStoreCredentialsError extends Error {\n    constructor(message = DEFAULT_MESSAGE){\n        super(message);\n        this.name = \"EdgeStoreCredentialsError\";\n    }\n}\nconst API_ENDPOINT = process.env.EDGE_STORE_API_ENDPOINT ?? \"https://api.edgestore.dev\";\nasync function makeRequest(params) {\n    const { body, accessKey, secretKey, path } = params;\n    const res = await fetch(`${API_ENDPOINT}${path}`, {\n        method: \"POST\",\n        body: JSON.stringify(body),\n        headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Basic ${Buffer.from(`${accessKey}:${secretKey}`).toString(\"base64\")}`\n        }\n    });\n    if (!res.ok) {\n        throw new Error(`Failed to make request to ${path}: ${await res.text()}`);\n    }\n    return await res.json();\n}\nconst edgeStoreRawSdk = {\n    async getToken (params) {\n        const reqBuckets = Object.entries(params.router.buckets).reduce((acc, [bucketName, bucket])=>{\n            acc[bucketName] = {\n                path: bucket._def.path.map((p)=>{\n                    const paramEntries = Object.entries(p);\n                    if (paramEntries[0] === undefined) {\n                        throw new Error(\"Missing path param\");\n                    }\n                    const [key, value] = paramEntries[0];\n                    return {\n                        key,\n                        value: value()\n                    };\n                }),\n                accessControl: bucket._def.accessControl\n            };\n            return acc;\n        }, {});\n        const { token } = await makeRequest({\n            body: {\n                ctx: params.ctx,\n                buckets: reqBuckets\n            },\n            accessKey: params.accessKey,\n            secretKey: params.secretKey,\n            path: \"/get-token\"\n        });\n        return token;\n    },\n    async getFile ({ accessKey, secretKey, url }) {\n        return await makeRequest({\n            path: \"/get-file\",\n            accessKey,\n            secretKey,\n            body: {\n                url\n            }\n        });\n    },\n    async requestUpload ({ accessKey, secretKey, bucketName, bucketType, fileInfo, multipart }) {\n        const res = await makeRequest({\n            path: \"/request-upload\",\n            accessKey,\n            secretKey,\n            body: {\n                multipart,\n                bucketName,\n                bucketType,\n                isPublic: fileInfo.isPublic,\n                path: fileInfo.path,\n                extension: fileInfo.extension,\n                size: fileInfo.size,\n                mimeType: fileInfo.type,\n                metadata: fileInfo.metadata,\n                fileName: fileInfo.fileName,\n                replaceTargetUrl: fileInfo.replaceTargetUrl,\n                isTemporary: fileInfo.temporary\n            }\n        });\n        return {\n            multipart: res.multipart,\n            signedUrl: res.signedUrl,\n            accessUrl: res.url,\n            path: res.path,\n            thumbnailUrl: res.thumbnailUrl\n        };\n    },\n    async requestUploadParts ({ accessKey, secretKey, key, multipart }) {\n        const res = await makeRequest({\n            path: \"/request-upload-parts\",\n            accessKey,\n            secretKey,\n            body: {\n                multipart,\n                key\n            }\n        });\n        return {\n            multipart: res.multipart\n        };\n    },\n    async completeMultipartUpload ({ accessKey, secretKey, uploadId, key, parts }) {\n        return await makeRequest({\n            path: \"/complete-multipart-upload\",\n            accessKey,\n            secretKey,\n            body: {\n                uploadId,\n                key,\n                parts\n            }\n        });\n    },\n    async confirmUpload ({ accessKey, secretKey, url }) {\n        return await makeRequest({\n            path: \"/confirm-upload\",\n            accessKey,\n            secretKey,\n            body: {\n                url\n            }\n        });\n    },\n    async deleteFile ({ accessKey, secretKey, url }) {\n        return await makeRequest({\n            path: \"/delete-file\",\n            accessKey,\n            secretKey,\n            body: {\n                url\n            }\n        });\n    },\n    async listFiles ({ accessKey, secretKey, bucketName, filter, pagination }) {\n        return await makeRequest({\n            path: \"/list-files\",\n            accessKey,\n            secretKey,\n            body: {\n                bucketName,\n                filter,\n                pagination\n            }\n        });\n    }\n};\nfunction initEdgeStoreSdk(params) {\n    const { accessKey = process.env.EDGE_STORE_ACCESS_KEY, secretKey = process.env.EDGE_STORE_SECRET_KEY } = params ?? {};\n    if (!accessKey || !secretKey) {\n        throw new EdgeStoreCredentialsError();\n    }\n    return {\n        async getToken (params) {\n            return await edgeStoreRawSdk.getToken({\n                accessKey,\n                secretKey,\n                ctx: params.ctx,\n                router: params.router\n            });\n        },\n        async getFile ({ url }) {\n            return await edgeStoreRawSdk.getFile({\n                accessKey,\n                secretKey,\n                url\n            });\n        },\n        async requestUpload ({ bucketName, bucketType, fileInfo, multipart }) {\n            return await edgeStoreRawSdk.requestUpload({\n                accessKey,\n                secretKey,\n                bucketName,\n                bucketType,\n                fileInfo,\n                multipart\n            });\n        },\n        async requestUploadParts ({ key, multipart }) {\n            return await edgeStoreRawSdk.requestUploadParts({\n                accessKey,\n                secretKey,\n                key,\n                multipart\n            });\n        },\n        async completeMultipartUpload ({ uploadId, key, parts }) {\n            return await edgeStoreRawSdk.completeMultipartUpload({\n                accessKey,\n                secretKey,\n                uploadId,\n                key,\n                parts\n            });\n        },\n        async confirmUpload ({ url }) {\n            return await edgeStoreRawSdk.confirmUpload({\n                accessKey,\n                secretKey,\n                url\n            });\n        },\n        async deleteFile ({ url }) {\n            return await edgeStoreRawSdk.deleteFile({\n                accessKey,\n                secretKey,\n                url\n            });\n        },\n        async listFiles (params) {\n            return await edgeStoreRawSdk.listFiles({\n                accessKey,\n                secretKey,\n                ...params\n            });\n        }\n    };\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9pbmRleC0zMGEzNzQxZS5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsTUFBTUEsa0JBQWtCLENBQUM7O3NEQUU2QixDQUFDO0FBQ3ZELE1BQU1DLGtDQUFrQ0M7SUFDcENDLFlBQVlDLFVBQVVKLGVBQWUsQ0FBQztRQUNsQyxLQUFLLENBQUNJO1FBQ04sSUFBSSxDQUFDQyxJQUFJLEdBQUc7SUFDaEI7QUFDSjtBQUVBLE1BQU1DLGVBQWVDLFFBQVFDLEdBQUcsQ0FBQ0MsdUJBQXVCLElBQUk7QUFDNUQsZUFBZUMsWUFBWUMsTUFBTTtJQUM3QixNQUFNLEVBQUVDLElBQUksRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUVDLElBQUksRUFBRSxHQUFHSjtJQUM3QyxNQUFNSyxNQUFNLE1BQU1DLE1BQU0sQ0FBQyxFQUFFWCxhQUFhLEVBQUVTLEtBQUssQ0FBQyxFQUFFO1FBQzlDRyxRQUFRO1FBQ1JOLE1BQU1PLEtBQUtDLFNBQVMsQ0FBQ1I7UUFDckJTLFNBQVM7WUFDTCxnQkFBZ0I7WUFDaEJDLGVBQWUsQ0FBQyxNQUFNLEVBQUVDLE9BQU9DLElBQUksQ0FBQyxDQUFDLEVBQUVYLFVBQVUsQ0FBQyxFQUFFQyxVQUFVLENBQUMsRUFBRVcsUUFBUSxDQUFDLFVBQVUsQ0FBQztRQUN6RjtJQUNKO0lBQ0EsSUFBSSxDQUFDVCxJQUFJVSxFQUFFLEVBQUU7UUFDVCxNQUFNLElBQUl4QixNQUFNLENBQUMsMEJBQTBCLEVBQUVhLEtBQUssRUFBRSxFQUFFLE1BQU1DLElBQUlXLElBQUksR0FBRyxDQUFDO0lBQzVFO0lBQ0EsT0FBTyxNQUFNWCxJQUFJWSxJQUFJO0FBQ3pCO0FBQ0EsTUFBTUMsa0JBQWtCO0lBQ3BCLE1BQU1DLFVBQVVuQixNQUFNO1FBQ2xCLE1BQU1vQixhQUFhQyxPQUFPQyxPQUFPLENBQUN0QixPQUFPdUIsTUFBTSxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sQ0FBQyxDQUFDQyxLQUFLLENBQUNDLFlBQVlDLE9BQU87WUFDdEZGLEdBQUcsQ0FBQ0MsV0FBVyxHQUFHO2dCQUNkdkIsTUFBTXdCLE9BQU9DLElBQUksQ0FBQ3pCLElBQUksQ0FBQzBCLEdBQUcsQ0FBQyxDQUFDQztvQkFDeEIsTUFBTUMsZUFBZVgsT0FBT0MsT0FBTyxDQUFDUztvQkFDcEMsSUFBSUMsWUFBWSxDQUFDLEVBQUUsS0FBS0MsV0FBVzt3QkFDL0IsTUFBTSxJQUFJMUMsTUFBTTtvQkFDcEI7b0JBQ0EsTUFBTSxDQUFDMkMsS0FBS0MsTUFBTSxHQUFHSCxZQUFZLENBQUMsRUFBRTtvQkFDcEMsT0FBTzt3QkFDSEU7d0JBQ0FDLE9BQU9BO29CQUNYO2dCQUNKO2dCQUNBQyxlQUFlUixPQUFPQyxJQUFJLENBQUNPLGFBQWE7WUFDNUM7WUFDQSxPQUFPVjtRQUNYLEdBQUcsQ0FBQztRQUNKLE1BQU0sRUFBRVcsS0FBSyxFQUFFLEdBQUcsTUFBTXRDLFlBQVk7WUFDaENFLE1BQU07Z0JBQ0ZxQyxLQUFLdEMsT0FBT3NDLEdBQUc7Z0JBQ2ZkLFNBQVNKO1lBQ2I7WUFDQWxCLFdBQVdGLE9BQU9FLFNBQVM7WUFDM0JDLFdBQVdILE9BQU9HLFNBQVM7WUFDM0JDLE1BQU07UUFDVjtRQUNBLE9BQU9pQztJQUNYO0lBQ0EsTUFBTUUsU0FBUyxFQUFFckMsU0FBUyxFQUFFQyxTQUFTLEVBQUVxQyxHQUFHLEVBQUU7UUFDeEMsT0FBTyxNQUFNekMsWUFBWTtZQUNyQkssTUFBTTtZQUNORjtZQUNBQztZQUNBRixNQUFNO2dCQUNGdUM7WUFDSjtRQUNKO0lBQ0o7SUFDQSxNQUFNQyxlQUFlLEVBQUV2QyxTQUFTLEVBQUVDLFNBQVMsRUFBRXdCLFVBQVUsRUFBRWUsVUFBVSxFQUFFQyxRQUFRLEVBQUVDLFNBQVMsRUFBRTtRQUN0RixNQUFNdkMsTUFBTSxNQUFNTixZQUFZO1lBQzFCSyxNQUFNO1lBQ05GO1lBQ0FDO1lBQ0FGLE1BQU07Z0JBQ0YyQztnQkFDQWpCO2dCQUNBZTtnQkFDQUcsVUFBVUYsU0FBU0UsUUFBUTtnQkFDM0J6QyxNQUFNdUMsU0FBU3ZDLElBQUk7Z0JBQ25CMEMsV0FBV0gsU0FBU0csU0FBUztnQkFDN0JDLE1BQU1KLFNBQVNJLElBQUk7Z0JBQ25CQyxVQUFVTCxTQUFTTSxJQUFJO2dCQUN2QkMsVUFBVVAsU0FBU08sUUFBUTtnQkFDM0JDLFVBQVVSLFNBQVNRLFFBQVE7Z0JBQzNCQyxrQkFBa0JULFNBQVNTLGdCQUFnQjtnQkFDM0NDLGFBQWFWLFNBQVNXLFNBQVM7WUFDbkM7UUFDSjtRQUNBLE9BQU87WUFDSFYsV0FBV3ZDLElBQUl1QyxTQUFTO1lBQ3hCVyxXQUFXbEQsSUFBSWtELFNBQVM7WUFDeEJDLFdBQVduRCxJQUFJbUMsR0FBRztZQUNsQnBDLE1BQU1DLElBQUlELElBQUk7WUFDZHFELGNBQWNwRCxJQUFJb0QsWUFBWTtRQUNsQztJQUNKO0lBQ0EsTUFBTUMsb0JBQW9CLEVBQUV4RCxTQUFTLEVBQUVDLFNBQVMsRUFBRStCLEdBQUcsRUFBRVUsU0FBUyxFQUFFO1FBQzlELE1BQU12QyxNQUFNLE1BQU1OLFlBQVk7WUFDMUJLLE1BQU07WUFDTkY7WUFDQUM7WUFDQUYsTUFBTTtnQkFDRjJDO2dCQUNBVjtZQUNKO1FBQ0o7UUFDQSxPQUFPO1lBQ0hVLFdBQVd2QyxJQUFJdUMsU0FBUztRQUM1QjtJQUNKO0lBQ0EsTUFBTWUseUJBQXlCLEVBQUV6RCxTQUFTLEVBQUVDLFNBQVMsRUFBRXlELFFBQVEsRUFBRTFCLEdBQUcsRUFBRTJCLEtBQUssRUFBRTtRQUN6RSxPQUFPLE1BQU05RCxZQUFZO1lBQ3JCSyxNQUFNO1lBQ05GO1lBQ0FDO1lBQ0FGLE1BQU07Z0JBQ0YyRDtnQkFDQTFCO2dCQUNBMkI7WUFDSjtRQUNKO0lBQ0o7SUFDQSxNQUFNQyxlQUFlLEVBQUU1RCxTQUFTLEVBQUVDLFNBQVMsRUFBRXFDLEdBQUcsRUFBRTtRQUM5QyxPQUFPLE1BQU16QyxZQUFZO1lBQ3JCSyxNQUFNO1lBQ05GO1lBQ0FDO1lBQ0FGLE1BQU07Z0JBQ0Z1QztZQUNKO1FBQ0o7SUFDSjtJQUNBLE1BQU11QixZQUFZLEVBQUU3RCxTQUFTLEVBQUVDLFNBQVMsRUFBRXFDLEdBQUcsRUFBRTtRQUMzQyxPQUFPLE1BQU16QyxZQUFZO1lBQ3JCSyxNQUFNO1lBQ05GO1lBQ0FDO1lBQ0FGLE1BQU07Z0JBQ0Z1QztZQUNKO1FBQ0o7SUFDSjtJQUNBLE1BQU13QixXQUFXLEVBQUU5RCxTQUFTLEVBQUVDLFNBQVMsRUFBRXdCLFVBQVUsRUFBRXNDLE1BQU0sRUFBRUMsVUFBVSxFQUFFO1FBQ3JFLE9BQU8sTUFBTW5FLFlBQVk7WUFDckJLLE1BQU07WUFDTkY7WUFDQUM7WUFDQUYsTUFBTTtnQkFDRjBCO2dCQUNBc0M7Z0JBQ0FDO1lBQ0o7UUFDSjtJQUNKO0FBQ0o7QUFDQSxTQUFTQyxpQkFBaUJuRSxNQUFNO0lBQzVCLE1BQU0sRUFBRUUsWUFBWU4sUUFBUUMsR0FBRyxDQUFDdUUscUJBQXFCLEVBQUVqRSxZQUFZUCxRQUFRQyxHQUFHLENBQUN3RSxxQkFBcUIsRUFBRSxHQUFHckUsVUFBVSxDQUFDO0lBQ3BILElBQUksQ0FBQ0UsYUFBYSxDQUFDQyxXQUFXO1FBQzFCLE1BQU0sSUFBSWI7SUFDZDtJQUNBLE9BQU87UUFDSCxNQUFNNkIsVUFBVW5CLE1BQU07WUFDbEIsT0FBTyxNQUFNa0IsZ0JBQWdCQyxRQUFRLENBQUM7Z0JBQ2xDakI7Z0JBQ0FDO2dCQUNBbUMsS0FBS3RDLE9BQU9zQyxHQUFHO2dCQUNmZixRQUFRdkIsT0FBT3VCLE1BQU07WUFDekI7UUFDSjtRQUNBLE1BQU1nQixTQUFTLEVBQUVDLEdBQUcsRUFBRTtZQUNsQixPQUFPLE1BQU10QixnQkFBZ0JxQixPQUFPLENBQUM7Z0JBQ2pDckM7Z0JBQ0FDO2dCQUNBcUM7WUFDSjtRQUNKO1FBQ0EsTUFBTUMsZUFBZSxFQUFFZCxVQUFVLEVBQUVlLFVBQVUsRUFBRUMsUUFBUSxFQUFFQyxTQUFTLEVBQUU7WUFDaEUsT0FBTyxNQUFNMUIsZ0JBQWdCdUIsYUFBYSxDQUFDO2dCQUN2Q3ZDO2dCQUNBQztnQkFDQXdCO2dCQUNBZTtnQkFDQUM7Z0JBQ0FDO1lBQ0o7UUFDSjtRQUNBLE1BQU1jLG9CQUFvQixFQUFFeEIsR0FBRyxFQUFFVSxTQUFTLEVBQUU7WUFDeEMsT0FBTyxNQUFNMUIsZ0JBQWdCd0Msa0JBQWtCLENBQUM7Z0JBQzVDeEQ7Z0JBQ0FDO2dCQUNBK0I7Z0JBQ0FVO1lBQ0o7UUFDSjtRQUNBLE1BQU1lLHlCQUF5QixFQUFFQyxRQUFRLEVBQUUxQixHQUFHLEVBQUUyQixLQUFLLEVBQUU7WUFDbkQsT0FBTyxNQUFNM0MsZ0JBQWdCeUMsdUJBQXVCLENBQUM7Z0JBQ2pEekQ7Z0JBQ0FDO2dCQUNBeUQ7Z0JBQ0ExQjtnQkFDQTJCO1lBQ0o7UUFDSjtRQUNBLE1BQU1DLGVBQWUsRUFBRXRCLEdBQUcsRUFBRTtZQUN4QixPQUFPLE1BQU10QixnQkFBZ0I0QyxhQUFhLENBQUM7Z0JBQ3ZDNUQ7Z0JBQ0FDO2dCQUNBcUM7WUFDSjtRQUNKO1FBQ0EsTUFBTXVCLFlBQVksRUFBRXZCLEdBQUcsRUFBRTtZQUNyQixPQUFPLE1BQU10QixnQkFBZ0I2QyxVQUFVLENBQUM7Z0JBQ3BDN0Q7Z0JBQ0FDO2dCQUNBcUM7WUFDSjtRQUNKO1FBQ0EsTUFBTXdCLFdBQVdoRSxNQUFNO1lBQ25CLE9BQU8sTUFBTWtCLGdCQUFnQjhDLFNBQVMsQ0FBQztnQkFDbkM5RDtnQkFDQUM7Z0JBQ0EsR0FBR0gsTUFBTTtZQUNiO1FBQ0o7SUFDSjtBQUNKO0FBRXVGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vemVuYm9hcmQvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9pbmRleC0zMGEzNzQxZS5tanM/NTZhYyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBERUZBVUxUX01FU1NBR0UgPSBgTWlzc2luZyBFREdFX1NUT1JFX0FDQ0VTU19LRVkgb3IgRURHRV9TVE9SRV9TRUNSRVRfS0VZLiBcblRoaXMgY2FuIGhhcHBlbiBpZiB5b3UgYXJlIHRyeWluZyB0byB1c2UgdGhlIHZhbmlsbGEgY2xpZW50IGluIHlvdXIgZnJvbnRlbmQuXG5UaGUgdmFuaWxsYSBjbGllbnQgc2hvdWxkIG9ubHkgYmUgdXNlZCBpbiB0aGUgYmFja2VuZC5gO1xuY2xhc3MgRWRnZVN0b3JlQ3JlZGVudGlhbHNFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlID0gREVGQVVMVF9NRVNTQUdFKXtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICAgIHRoaXMubmFtZSA9ICdFZGdlU3RvcmVDcmVkZW50aWFsc0Vycm9yJztcbiAgICB9XG59XG5cbmNvbnN0IEFQSV9FTkRQT0lOVCA9IHByb2Nlc3MuZW52LkVER0VfU1RPUkVfQVBJX0VORFBPSU5UID8/ICdodHRwczovL2FwaS5lZGdlc3RvcmUuZGV2JztcbmFzeW5jIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHBhcmFtcykge1xuICAgIGNvbnN0IHsgYm9keSwgYWNjZXNzS2V5LCBzZWNyZXRLZXksIHBhdGggfSA9IHBhcmFtcztcbiAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaChgJHtBUElfRU5EUE9JTlR9JHtwYXRofWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGJvZHkpLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7QnVmZmVyLmZyb20oYCR7YWNjZXNzS2V5fToke3NlY3JldEtleX1gKS50b1N0cmluZygnYmFzZTY0Jyl9YFxuICAgICAgICB9XG4gICAgfSk7XG4gICAgaWYgKCFyZXMub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gbWFrZSByZXF1ZXN0IHRvICR7cGF0aH06ICR7YXdhaXQgcmVzLnRleHQoKX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHJlcy5qc29uKCk7XG59XG5jb25zdCBlZGdlU3RvcmVSYXdTZGsgPSB7XG4gICAgYXN5bmMgZ2V0VG9rZW4gKHBhcmFtcykge1xuICAgICAgICBjb25zdCByZXFCdWNrZXRzID0gT2JqZWN0LmVudHJpZXMocGFyYW1zLnJvdXRlci5idWNrZXRzKS5yZWR1Y2UoKGFjYywgW2J1Y2tldE5hbWUsIGJ1Y2tldF0pPT57XG4gICAgICAgICAgICBhY2NbYnVja2V0TmFtZV0gPSB7XG4gICAgICAgICAgICAgICAgcGF0aDogYnVja2V0Ll9kZWYucGF0aC5tYXAoKHApPT57XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtRW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHApO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1FbnRyaWVzWzBdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBwYXRoIHBhcmFtJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gcGFyYW1FbnRyaWVzWzBdO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlKClcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBhY2Nlc3NDb250cm9sOiBidWNrZXQuX2RlZi5hY2Nlc3NDb250cm9sXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgfSwge30pO1xuICAgICAgICBjb25zdCB7IHRva2VuIH0gPSBhd2FpdCBtYWtlUmVxdWVzdCh7XG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgY3R4OiBwYXJhbXMuY3R4LFxuICAgICAgICAgICAgICAgIGJ1Y2tldHM6IHJlcUJ1Y2tldHNcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBhY2Nlc3NLZXk6IHBhcmFtcy5hY2Nlc3NLZXksXG4gICAgICAgICAgICBzZWNyZXRLZXk6IHBhcmFtcy5zZWNyZXRLZXksXG4gICAgICAgICAgICBwYXRoOiAnL2dldC10b2tlbidcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICAgIGFzeW5jIGdldEZpbGUgKHsgYWNjZXNzS2V5LCBzZWNyZXRLZXksIHVybCB9KSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBtYWtlUmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiAnL2dldC1maWxlJyxcbiAgICAgICAgICAgIGFjY2Vzc0tleSxcbiAgICAgICAgICAgIHNlY3JldEtleSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICB1cmxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyByZXF1ZXN0VXBsb2FkICh7IGFjY2Vzc0tleSwgc2VjcmV0S2V5LCBidWNrZXROYW1lLCBidWNrZXRUeXBlLCBmaWxlSW5mbywgbXVsdGlwYXJ0IH0pIHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgbWFrZVJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogJy9yZXF1ZXN0LXVwbG9hZCcsXG4gICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICBzZWNyZXRLZXksXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgbXVsdGlwYXJ0LFxuICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWUsXG4gICAgICAgICAgICAgICAgYnVja2V0VHlwZSxcbiAgICAgICAgICAgICAgICBpc1B1YmxpYzogZmlsZUluZm8uaXNQdWJsaWMsXG4gICAgICAgICAgICAgICAgcGF0aDogZmlsZUluZm8ucGF0aCxcbiAgICAgICAgICAgICAgICBleHRlbnNpb246IGZpbGVJbmZvLmV4dGVuc2lvbixcbiAgICAgICAgICAgICAgICBzaXplOiBmaWxlSW5mby5zaXplLFxuICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBmaWxlSW5mby50eXBlLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBmaWxlSW5mby5tZXRhZGF0YSxcbiAgICAgICAgICAgICAgICBmaWxlTmFtZTogZmlsZUluZm8uZmlsZU5hbWUsXG4gICAgICAgICAgICAgICAgcmVwbGFjZVRhcmdldFVybDogZmlsZUluZm8ucmVwbGFjZVRhcmdldFVybCxcbiAgICAgICAgICAgICAgICBpc1RlbXBvcmFyeTogZmlsZUluZm8udGVtcG9yYXJ5XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbXVsdGlwYXJ0OiByZXMubXVsdGlwYXJ0LFxuICAgICAgICAgICAgc2lnbmVkVXJsOiByZXMuc2lnbmVkVXJsLFxuICAgICAgICAgICAgYWNjZXNzVXJsOiByZXMudXJsLFxuICAgICAgICAgICAgcGF0aDogcmVzLnBhdGgsXG4gICAgICAgICAgICB0aHVtYm5haWxVcmw6IHJlcy50aHVtYm5haWxVcmxcbiAgICAgICAgfTtcbiAgICB9LFxuICAgIGFzeW5jIHJlcXVlc3RVcGxvYWRQYXJ0cyAoeyBhY2Nlc3NLZXksIHNlY3JldEtleSwga2V5LCBtdWx0aXBhcnQgfSkge1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBtYWtlUmVxdWVzdCh7XG4gICAgICAgICAgICBwYXRoOiAnL3JlcXVlc3QtdXBsb2FkLXBhcnRzJyxcbiAgICAgICAgICAgIGFjY2Vzc0tleSxcbiAgICAgICAgICAgIHNlY3JldEtleSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICBtdWx0aXBhcnQsXG4gICAgICAgICAgICAgICAga2V5XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbXVsdGlwYXJ0OiByZXMubXVsdGlwYXJ0XG4gICAgICAgIH07XG4gICAgfSxcbiAgICBhc3luYyBjb21wbGV0ZU11bHRpcGFydFVwbG9hZCAoeyBhY2Nlc3NLZXksIHNlY3JldEtleSwgdXBsb2FkSWQsIGtleSwgcGFydHMgfSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgbWFrZVJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogJy9jb21wbGV0ZS1tdWx0aXBhcnQtdXBsb2FkJyxcbiAgICAgICAgICAgIGFjY2Vzc0tleSxcbiAgICAgICAgICAgIHNlY3JldEtleSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICB1cGxvYWRJZCxcbiAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgcGFydHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBjb25maXJtVXBsb2FkICh7IGFjY2Vzc0tleSwgc2VjcmV0S2V5LCB1cmwgfSkge1xuICAgICAgICByZXR1cm4gYXdhaXQgbWFrZVJlcXVlc3Qoe1xuICAgICAgICAgICAgcGF0aDogJy9jb25maXJtLXVwbG9hZCcsXG4gICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICBzZWNyZXRLZXksXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZGVsZXRlRmlsZSAoeyBhY2Nlc3NLZXksIHNlY3JldEtleSwgdXJsIH0pIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IG1ha2VSZXF1ZXN0KHtcbiAgICAgICAgICAgIHBhdGg6ICcvZGVsZXRlLWZpbGUnLFxuICAgICAgICAgICAgYWNjZXNzS2V5LFxuICAgICAgICAgICAgc2VjcmV0S2V5LFxuICAgICAgICAgICAgYm9keToge1xuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGxpc3RGaWxlcyAoeyBhY2Nlc3NLZXksIHNlY3JldEtleSwgYnVja2V0TmFtZSwgZmlsdGVyLCBwYWdpbmF0aW9uIH0pIHtcbiAgICAgICAgcmV0dXJuIGF3YWl0IG1ha2VSZXF1ZXN0KHtcbiAgICAgICAgICAgIHBhdGg6ICcvbGlzdC1maWxlcycsXG4gICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICBzZWNyZXRLZXksXG4gICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgYnVja2V0TmFtZSxcbiAgICAgICAgICAgICAgICBmaWx0ZXIsXG4gICAgICAgICAgICAgICAgcGFnaW5hdGlvblxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59O1xuZnVuY3Rpb24gaW5pdEVkZ2VTdG9yZVNkayhwYXJhbXMpIHtcbiAgICBjb25zdCB7IGFjY2Vzc0tleSA9IHByb2Nlc3MuZW52LkVER0VfU1RPUkVfQUNDRVNTX0tFWSwgc2VjcmV0S2V5ID0gcHJvY2Vzcy5lbnYuRURHRV9TVE9SRV9TRUNSRVRfS0VZIH0gPSBwYXJhbXMgPz8ge307XG4gICAgaWYgKCFhY2Nlc3NLZXkgfHwgIXNlY3JldEtleSkge1xuICAgICAgICB0aHJvdyBuZXcgRWRnZVN0b3JlQ3JlZGVudGlhbHNFcnJvcigpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBhc3luYyBnZXRUb2tlbiAocGFyYW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRnZVN0b3JlUmF3U2RrLmdldFRva2VuKHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICAgICAgc2VjcmV0S2V5LFxuICAgICAgICAgICAgICAgIGN0eDogcGFyYW1zLmN0eCxcbiAgICAgICAgICAgICAgICByb3V0ZXI6IHBhcmFtcy5yb3V0ZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBnZXRGaWxlICh7IHVybCB9KSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRnZVN0b3JlUmF3U2RrLmdldEZpbGUoe1xuICAgICAgICAgICAgICAgIGFjY2Vzc0tleSxcbiAgICAgICAgICAgICAgICBzZWNyZXRLZXksXG4gICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgcmVxdWVzdFVwbG9hZCAoeyBidWNrZXROYW1lLCBidWNrZXRUeXBlLCBmaWxlSW5mbywgbXVsdGlwYXJ0IH0pIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGdlU3RvcmVSYXdTZGsucmVxdWVzdFVwbG9hZCh7XG4gICAgICAgICAgICAgICAgYWNjZXNzS2V5LFxuICAgICAgICAgICAgICAgIHNlY3JldEtleSxcbiAgICAgICAgICAgICAgICBidWNrZXROYW1lLFxuICAgICAgICAgICAgICAgIGJ1Y2tldFR5cGUsXG4gICAgICAgICAgICAgICAgZmlsZUluZm8sXG4gICAgICAgICAgICAgICAgbXVsdGlwYXJ0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgcmVxdWVzdFVwbG9hZFBhcnRzICh7IGtleSwgbXVsdGlwYXJ0IH0pIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGdlU3RvcmVSYXdTZGsucmVxdWVzdFVwbG9hZFBhcnRzKHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICAgICAgc2VjcmV0S2V5LFxuICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICBtdWx0aXBhcnRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBjb21wbGV0ZU11bHRpcGFydFVwbG9hZCAoeyB1cGxvYWRJZCwga2V5LCBwYXJ0cyB9KSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRnZVN0b3JlUmF3U2RrLmNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkKHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICAgICAgc2VjcmV0S2V5LFxuICAgICAgICAgICAgICAgIHVwbG9hZElkLFxuICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICBwYXJ0c1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIGNvbmZpcm1VcGxvYWQgKHsgdXJsIH0pIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGdlU3RvcmVSYXdTZGsuY29uZmlybVVwbG9hZCh7XG4gICAgICAgICAgICAgICAgYWNjZXNzS2V5LFxuICAgICAgICAgICAgICAgIHNlY3JldEtleSxcbiAgICAgICAgICAgICAgICB1cmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBkZWxldGVGaWxlICh7IHVybCB9KSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRnZVN0b3JlUmF3U2RrLmRlbGV0ZUZpbGUoe1xuICAgICAgICAgICAgICAgIGFjY2Vzc0tleSxcbiAgICAgICAgICAgICAgICBzZWNyZXRLZXksXG4gICAgICAgICAgICAgICAgdXJsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgbGlzdEZpbGVzIChwYXJhbXMpIHtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGdlU3RvcmVSYXdTZGsubGlzdEZpbGVzKHtcbiAgICAgICAgICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgICAgICAgICAgc2VjcmV0S2V5LFxuICAgICAgICAgICAgICAgIC4uLnBhcmFtc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5leHBvcnQgeyBFZGdlU3RvcmVDcmVkZW50aWFsc0Vycm9yIGFzIEUsIGVkZ2VTdG9yZVJhd1NkayBhcyBlLCBpbml0RWRnZVN0b3JlU2RrIGFzIGkgfTtcbiJdLCJuYW1lcyI6WyJERUZBVUxUX01FU1NBR0UiLCJFZGdlU3RvcmVDcmVkZW50aWFsc0Vycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm1lc3NhZ2UiLCJuYW1lIiwiQVBJX0VORFBPSU5UIiwicHJvY2VzcyIsImVudiIsIkVER0VfU1RPUkVfQVBJX0VORFBPSU5UIiwibWFrZVJlcXVlc3QiLCJwYXJhbXMiLCJib2R5IiwiYWNjZXNzS2V5Iiwic2VjcmV0S2V5IiwicGF0aCIsInJlcyIsImZldGNoIiwibWV0aG9kIiwiSlNPTiIsInN0cmluZ2lmeSIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwiQnVmZmVyIiwiZnJvbSIsInRvU3RyaW5nIiwib2siLCJ0ZXh0IiwianNvbiIsImVkZ2VTdG9yZVJhd1NkayIsImdldFRva2VuIiwicmVxQnVja2V0cyIsIk9iamVjdCIsImVudHJpZXMiLCJyb3V0ZXIiLCJidWNrZXRzIiwicmVkdWNlIiwiYWNjIiwiYnVja2V0TmFtZSIsImJ1Y2tldCIsIl9kZWYiLCJtYXAiLCJwIiwicGFyYW1FbnRyaWVzIiwidW5kZWZpbmVkIiwia2V5IiwidmFsdWUiLCJhY2Nlc3NDb250cm9sIiwidG9rZW4iLCJjdHgiLCJnZXRGaWxlIiwidXJsIiwicmVxdWVzdFVwbG9hZCIsImJ1Y2tldFR5cGUiLCJmaWxlSW5mbyIsIm11bHRpcGFydCIsImlzUHVibGljIiwiZXh0ZW5zaW9uIiwic2l6ZSIsIm1pbWVUeXBlIiwidHlwZSIsIm1ldGFkYXRhIiwiZmlsZU5hbWUiLCJyZXBsYWNlVGFyZ2V0VXJsIiwiaXNUZW1wb3JhcnkiLCJ0ZW1wb3JhcnkiLCJzaWduZWRVcmwiLCJhY2Nlc3NVcmwiLCJ0aHVtYm5haWxVcmwiLCJyZXF1ZXN0VXBsb2FkUGFydHMiLCJjb21wbGV0ZU11bHRpcGFydFVwbG9hZCIsInVwbG9hZElkIiwicGFydHMiLCJjb25maXJtVXBsb2FkIiwiZGVsZXRlRmlsZSIsImxpc3RGaWxlcyIsImZpbHRlciIsInBhZ2luYXRpb24iLCJpbml0RWRnZVN0b3JlU2RrIiwiRURHRV9TVE9SRV9BQ0NFU1NfS0VZIiwiRURHRV9TVE9SRV9TRUNSRVRfS0VZIiwiRSIsImUiLCJpIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@edgestore/server/dist/index-30a3741e.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@edgestore/server/dist/index.mjs":
/*!*******************************************************!*\
  !*** ./node_modules/@edgestore/server/dist/index.mjs ***!
  \*******************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   initEdgeStore: () => (/* binding */ initEdgeStore)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/lib/index.mjs\");\n\n/**\n * Creates a Proxy that prints the path to the property when called.\n *\n * Example:\n *\n * ```ts\n * const pathParamProxy = createPathParamProxy();\n * console.log(pathParamProxy.ctx.user.id());\n * // Logs: \"ctx.user.id\"\n * console.log(pathParamProxy.input.type());\n * // Logs: \"input.type\"\n * ```\n */ function createPathParamProxy() {\n    const getPath = (target, _prop)=>{\n        const proxyFunction = ()=>target;\n        return new Proxy(proxyFunction, {\n            get: (_target, propChild)=>{\n                return getPath(`${target}.${String(propChild)}`);\n            }\n        });\n    };\n    return new Proxy(()=>\"\", {\n        get: (_target, prop)=>{\n            return getPath(String(prop));\n        }\n    });\n}\nconst createNewBuilder = (initDef, newDef)=>{\n    const mergedDef = {\n        ...initDef,\n        ...newDef\n    };\n    return createBuilder({\n        type: mergedDef.type\n    }, mergedDef);\n};\nfunction createBuilder(opts, initDef) {\n    const _def = {\n        type: opts.type,\n        input: zod__WEBPACK_IMPORTED_MODULE_0__.z.never(),\n        path: [],\n        metadata: ()=>({}),\n        ...initDef\n    };\n    return {\n        $config: {\n            ctx: undefined\n        },\n        // @ts-expect-error - I think it would be too much work to make this type correct.\n        _def,\n        input (input) {\n            return createNewBuilder(_def, {\n                input\n            });\n        },\n        path (pathResolver) {\n            // TODO: Should throw a runtime error in the followin cases:\n            // 1. in case of multiple keys in one object\n            // 2. in case of duplicate keys\n            const pathParamProxy = createPathParamProxy();\n            const params = pathResolver(pathParamProxy);\n            return createNewBuilder(_def, {\n                path: params\n            });\n        },\n        metadata (metadata) {\n            return createNewBuilder(_def, {\n                metadata\n            });\n        },\n        accessControl (accessControl) {\n            return createNewBuilder(_def, {\n                accessControl: accessControl\n            });\n        },\n        beforeUpload (beforeUpload) {\n            return createNewBuilder(_def, {\n                beforeUpload\n            });\n        },\n        beforeDelete (beforeDelete) {\n            return createNewBuilder(_def, {\n                beforeDelete\n            });\n        }\n    };\n}\nclass EdgeStoreBuilder {\n    context() {\n        return new EdgeStoreBuilder();\n    }\n    create() {\n        return createEdgeStoreInner()();\n    }\n}\nfunction createRouterFactory() {\n    return function createRouterInner(buckets) {\n        return {\n            $config: {\n                ctx: undefined\n            },\n            buckets\n        };\n    };\n}\nfunction initBucket(type, config) {\n    return createBuilder({\n        type\n    }, {\n        bucketConfig: config\n    });\n}\nfunction createEdgeStoreInner() {\n    return function initEdgeStoreInner() {\n        return {\n            /**\n       * Builder object for creating an image bucket\n       */ imageBucket (config) {\n                return initBucket(\"IMAGE\", config);\n            },\n            /**\n       * Builder object for creating a file bucket\n       */ fileBucket (config) {\n                return initBucket(\"FILE\", config);\n            },\n            /**\n       * Create a router\n       */ router: createRouterFactory()\n        };\n    };\n}\n/**\n * Initialize EdgeStore - be done exactly once per backend\n */ const initEdgeStore = new EdgeStoreBuilder(); // ↓↓↓ TYPE TESTS ↓↓↓\n// type Context = {\n//   userId: string;\n//   userRole: 'admin' | 'visitor';\n// };\n// const es = initEdgeStore.context<Context>().create();\n// const imagesBucket = es.imageBucket()\n//   .input(\n//     z.object({\n//       type: z.enum(['profile', 'post']),\n//       extension: z.string().optional(),\n//     }),\n//   )\n//   .path(({ ctx, input }) => [{ author: ctx.userId }, { type: input.type }])\n//   .metadata(({ ctx, input }) => ({\n//     extension: input.extension,\n//     role: ctx.userRole,\n//   }))\n//   .beforeUpload(() => {\n//     return true;\n//   });\n// const a = es.imageBucket()\n//   .input(z.object({ type: z.string(), someMeta: z.string().optional() }))\n//   .path(({ ctx, input }) => [{ author: ctx.userId }, { type: input.type }])\n//   .metadata(({ ctx, input }) => ({\n//     role: ctx.userRole,\n//     someMeta: input.someMeta,\n//   }))\n//   .accessControl({\n//     OR: [\n//       {\n//         userId: { path: 'author' }, // this will check if the userId is the same as the author in the path parameter\n//       },\n//       {\n//         userRole: 'admin', // this is the same as { userRole: { eq: \"admin\" } }\n//       },\n//     ],\n//   })\n//   .beforeUpload(({ ctx, input }) => {\n//     return true;\n//   })\n//   .beforeDelete(({ ctx, file }) => {\n//     return true;\n//   });\n// const b = es.imageBucket().path(({ ctx }) => [{ author: ctx.userId }]);\n// const router = es.router({\n//   original: imagesBucket,\n//   imageBucket: a,\n//   imageBucket2: b,\n// });\n// export { router };\n// type ListFilesResponse<TBucket extends AnyRouter['buckets'][string]> = {\n//   data: {\n//     // url: string;\n//     // size: number;\n//     // uploadedAt: Date;\n//     // metadata: InferMetadataObject<TBucket>;\n//     path: InferBucketPathKeys<TBucket> extends string ? {\n//       [key: string]: string;\n//     } :{\n//       [TKey in InferBucketPathKeys<TBucket>]: string;\n//     };\n//   }[];\n//   pagination: {\n//     currentPage: number;\n//     totalPages: number;\n//     totalCount: number;\n//   };\n// };\n// type TPathKeys = 'author' | 'type';\n// type TPathKeys2 = InferBucketPathKeys<AnyBuilder>;\n// type ObjectWithKeys<TKeys extends string> = {\n//   [TKey in TKeys]: string;\n// };\n// type Test1 = ObjectWithKeys<TPathKeys>;\n// type Test2 = ObjectWithKeys<TPathKeys2>;\n// type PathKeys = InferBucketPathKeys<typeof router.buckets.imageBucket>;\n// type MetadataKeys = InferMetadataObject<typeof router.buckets.imageBucket>;\n// type MyEdgeStoreRouter = typeof router;\n// type MyAccessControl = AccessControlSchema<Context, AnyDef>;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBd0I7QUFFeEI7Ozs7Ozs7Ozs7OztDQVlDLEdBQUcsU0FBU0M7SUFDVCxNQUFNQyxVQUFVLENBQUNDLFFBQVFDO1FBQ3JCLE1BQU1DLGdCQUFnQixJQUFJRjtRQUMxQixPQUFPLElBQUlHLE1BQU1ELGVBQWU7WUFDNUJFLEtBQUssQ0FBQ0MsU0FBU0M7Z0JBQ1gsT0FBT1AsUUFBUSxDQUFDLEVBQUVDLE9BQU8sQ0FBQyxFQUFFTyxPQUFPRCxXQUFXLENBQUM7WUFDbkQ7UUFDSjtJQUNKO0lBQ0EsT0FBTyxJQUFJSCxNQUFNLElBQUksSUFBSTtRQUNyQkMsS0FBSyxDQUFDQyxTQUFTRztZQUNYLE9BQU9ULFFBQVFRLE9BQU9DO1FBQzFCO0lBQ0o7QUFDSjtBQUVBLE1BQU1DLG1CQUFtQixDQUFDQyxTQUFTQztJQUMvQixNQUFNQyxZQUFZO1FBQ2QsR0FBR0YsT0FBTztRQUNWLEdBQUdDLE1BQU07SUFDYjtJQUNBLE9BQU9FLGNBQWM7UUFDakJDLE1BQU1GLFVBQVVFLElBQUk7SUFDeEIsR0FBR0Y7QUFDUDtBQUNBLFNBQVNDLGNBQWNFLElBQUksRUFBRUwsT0FBTztJQUNoQyxNQUFNTSxPQUFPO1FBQ1RGLE1BQU1DLEtBQUtELElBQUk7UUFDZkcsT0FBT3BCLGtDQUFDQSxDQUFDcUIsS0FBSztRQUNkQyxNQUFNLEVBQUU7UUFDUkMsVUFBVSxJQUFLLEVBQUM7UUFDaEIsR0FBR1YsT0FBTztJQUNkO0lBQ0EsT0FBTztRQUNIVyxTQUFTO1lBQ0xDLEtBQUtDO1FBQ1Q7UUFDQSxrRkFBa0Y7UUFDbEZQO1FBQ0FDLE9BQU9BLEtBQUs7WUFDUixPQUFPUixpQkFBaUJPLE1BQU07Z0JBQzFCQztZQUNKO1FBQ0o7UUFDQUUsTUFBTUssWUFBWTtZQUNkLDREQUE0RDtZQUM1RCw0Q0FBNEM7WUFDNUMsK0JBQStCO1lBQy9CLE1BQU1DLGlCQUFp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O0FBRXZDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vemVuYm9hcmQvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9pbmRleC5tanM/YjZmOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB6IH0gZnJvbSAnem9kJztcblxuLyoqXG4gKiBDcmVhdGVzIGEgUHJveHkgdGhhdCBwcmludHMgdGhlIHBhdGggdG8gdGhlIHByb3BlcnR5IHdoZW4gY2FsbGVkLlxuICpcbiAqIEV4YW1wbGU6XG4gKlxuICogYGBgdHNcbiAqIGNvbnN0IHBhdGhQYXJhbVByb3h5ID0gY3JlYXRlUGF0aFBhcmFtUHJveHkoKTtcbiAqIGNvbnNvbGUubG9nKHBhdGhQYXJhbVByb3h5LmN0eC51c2VyLmlkKCkpO1xuICogLy8gTG9nczogXCJjdHgudXNlci5pZFwiXG4gKiBjb25zb2xlLmxvZyhwYXRoUGFyYW1Qcm94eS5pbnB1dC50eXBlKCkpO1xuICogLy8gTG9nczogXCJpbnB1dC50eXBlXCJcbiAqIGBgYFxuICovIGZ1bmN0aW9uIGNyZWF0ZVBhdGhQYXJhbVByb3h5KCkge1xuICAgIGNvbnN0IGdldFBhdGggPSAodGFyZ2V0LCBfcHJvcCk9PntcbiAgICAgICAgY29uc3QgcHJveHlGdW5jdGlvbiA9ICgpPT50YXJnZXQ7XG4gICAgICAgIHJldHVybiBuZXcgUHJveHkocHJveHlGdW5jdGlvbiwge1xuICAgICAgICAgICAgZ2V0OiAoX3RhcmdldCwgcHJvcENoaWxkKT0+e1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRQYXRoKGAke3RhcmdldH0uJHtTdHJpbmcocHJvcENoaWxkKX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gbmV3IFByb3h5KCgpPT4nJywge1xuICAgICAgICBnZXQ6IChfdGFyZ2V0LCBwcm9wKT0+e1xuICAgICAgICAgICAgcmV0dXJuIGdldFBhdGgoU3RyaW5nKHByb3ApKTtcbiAgICAgICAgfVxuICAgIH0pO1xufVxuXG5jb25zdCBjcmVhdGVOZXdCdWlsZGVyID0gKGluaXREZWYsIG5ld0RlZik9PntcbiAgICBjb25zdCBtZXJnZWREZWYgPSB7XG4gICAgICAgIC4uLmluaXREZWYsXG4gICAgICAgIC4uLm5ld0RlZlxuICAgIH07XG4gICAgcmV0dXJuIGNyZWF0ZUJ1aWxkZXIoe1xuICAgICAgICB0eXBlOiBtZXJnZWREZWYudHlwZVxuICAgIH0sIG1lcmdlZERlZik7XG59O1xuZnVuY3Rpb24gY3JlYXRlQnVpbGRlcihvcHRzLCBpbml0RGVmKSB7XG4gICAgY29uc3QgX2RlZiA9IHtcbiAgICAgICAgdHlwZTogb3B0cy50eXBlLFxuICAgICAgICBpbnB1dDogei5uZXZlcigpLFxuICAgICAgICBwYXRoOiBbXSxcbiAgICAgICAgbWV0YWRhdGE6ICgpPT4oe30pLFxuICAgICAgICAuLi5pbml0RGVmXG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICAkY29uZmlnOiB7XG4gICAgICAgICAgICBjdHg6IHVuZGVmaW5lZFxuICAgICAgICB9LFxuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC0gSSB0aGluayBpdCB3b3VsZCBiZSB0b28gbXVjaCB3b3JrIHRvIG1ha2UgdGhpcyB0eXBlIGNvcnJlY3QuXG4gICAgICAgIF9kZWYsXG4gICAgICAgIGlucHV0IChpbnB1dCkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU5ld0J1aWxkZXIoX2RlZiwge1xuICAgICAgICAgICAgICAgIGlucHV0XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgcGF0aCAocGF0aFJlc29sdmVyKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBTaG91bGQgdGhyb3cgYSBydW50aW1lIGVycm9yIGluIHRoZSBmb2xsb3dpbiBjYXNlczpcbiAgICAgICAgICAgIC8vIDEuIGluIGNhc2Ugb2YgbXVsdGlwbGUga2V5cyBpbiBvbmUgb2JqZWN0XG4gICAgICAgICAgICAvLyAyLiBpbiBjYXNlIG9mIGR1cGxpY2F0ZSBrZXlzXG4gICAgICAgICAgICBjb25zdCBwYXRoUGFyYW1Qcm94eSA9IGNyZWF0ZVBhdGhQYXJhbVByb3h5KCk7XG4gICAgICAgICAgICBjb25zdCBwYXJhbXMgPSBwYXRoUmVzb2x2ZXIocGF0aFBhcmFtUHJveHkpO1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU5ld0J1aWxkZXIoX2RlZiwge1xuICAgICAgICAgICAgICAgIHBhdGg6IHBhcmFtc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG1ldGFkYXRhIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU5ld0J1aWxkZXIoX2RlZiwge1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgYWNjZXNzQ29udHJvbCAoYWNjZXNzQ29udHJvbCkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU5ld0J1aWxkZXIoX2RlZiwge1xuICAgICAgICAgICAgICAgIGFjY2Vzc0NvbnRyb2w6IGFjY2Vzc0NvbnRyb2xcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBiZWZvcmVVcGxvYWQgKGJlZm9yZVVwbG9hZCkge1xuICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZU5ld0J1aWxkZXIoX2RlZiwge1xuICAgICAgICAgICAgICAgIGJlZm9yZVVwbG9hZFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGJlZm9yZURlbGV0ZSAoYmVmb3JlRGVsZXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlTmV3QnVpbGRlcihfZGVmLCB7XG4gICAgICAgICAgICAgICAgYmVmb3JlRGVsZXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5jbGFzcyBFZGdlU3RvcmVCdWlsZGVyIHtcbiAgICBjb250ZXh0KCkge1xuICAgICAgICByZXR1cm4gbmV3IEVkZ2VTdG9yZUJ1aWxkZXIoKTtcbiAgICB9XG4gICAgY3JlYXRlKCkge1xuICAgICAgICByZXR1cm4gY3JlYXRlRWRnZVN0b3JlSW5uZXIoKSgpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGNyZWF0ZVJvdXRlckZhY3RvcnkoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVJvdXRlcklubmVyKGJ1Y2tldHMpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICRjb25maWc6IHtcbiAgICAgICAgICAgICAgICBjdHg6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJ1Y2tldHNcbiAgICAgICAgfTtcbiAgICB9O1xufVxuZnVuY3Rpb24gaW5pdEJ1Y2tldCh0eXBlLCBjb25maWcpIHtcbiAgICByZXR1cm4gY3JlYXRlQnVpbGRlcih7XG4gICAgICAgIHR5cGVcbiAgICB9LCB7XG4gICAgICAgIGJ1Y2tldENvbmZpZzogY29uZmlnXG4gICAgfSk7XG59XG5mdW5jdGlvbiBjcmVhdGVFZGdlU3RvcmVJbm5lcigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gaW5pdEVkZ2VTdG9yZUlubmVyKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgKiBCdWlsZGVyIG9iamVjdCBmb3IgY3JlYXRpbmcgYW4gaW1hZ2UgYnVja2V0XG4gICAgICAgKi8gaW1hZ2VCdWNrZXQgKGNvbmZpZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbml0QnVja2V0KCdJTUFHRScsIGNvbmZpZyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgLyoqXG4gICAgICAgKiBCdWlsZGVyIG9iamVjdCBmb3IgY3JlYXRpbmcgYSBmaWxlIGJ1Y2tldFxuICAgICAgICovIGZpbGVCdWNrZXQgKGNvbmZpZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbml0QnVja2V0KCdGSUxFJywgY29uZmlnKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAvKipcbiAgICAgICAqIENyZWF0ZSBhIHJvdXRlclxuICAgICAgICovIHJvdXRlcjogY3JlYXRlUm91dGVyRmFjdG9yeSgpXG4gICAgICAgIH07XG4gICAgfTtcbn1cbi8qKlxuICogSW5pdGlhbGl6ZSBFZGdlU3RvcmUgLSBiZSBkb25lIGV4YWN0bHkgb25jZSBwZXIgYmFja2VuZFxuICovIGNvbnN0IGluaXRFZGdlU3RvcmUgPSBuZXcgRWRnZVN0b3JlQnVpbGRlcigpOyAvLyDihpPihpPihpMgVFlQRSBURVNUUyDihpPihpPihpNcbiAvLyB0eXBlIENvbnRleHQgPSB7XG4gLy8gICB1c2VySWQ6IHN0cmluZztcbiAvLyAgIHVzZXJSb2xlOiAnYWRtaW4nIHwgJ3Zpc2l0b3InO1xuIC8vIH07XG4gLy8gY29uc3QgZXMgPSBpbml0RWRnZVN0b3JlLmNvbnRleHQ8Q29udGV4dD4oKS5jcmVhdGUoKTtcbiAvLyBjb25zdCBpbWFnZXNCdWNrZXQgPSBlcy5pbWFnZUJ1Y2tldCgpXG4gLy8gICAuaW5wdXQoXG4gLy8gICAgIHoub2JqZWN0KHtcbiAvLyAgICAgICB0eXBlOiB6LmVudW0oWydwcm9maWxlJywgJ3Bvc3QnXSksXG4gLy8gICAgICAgZXh0ZW5zaW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gLy8gICAgIH0pLFxuIC8vICAgKVxuIC8vICAgLnBhdGgoKHsgY3R4LCBpbnB1dCB9KSA9PiBbeyBhdXRob3I6IGN0eC51c2VySWQgfSwgeyB0eXBlOiBpbnB1dC50eXBlIH1dKVxuIC8vICAgLm1ldGFkYXRhKCh7IGN0eCwgaW5wdXQgfSkgPT4gKHtcbiAvLyAgICAgZXh0ZW5zaW9uOiBpbnB1dC5leHRlbnNpb24sXG4gLy8gICAgIHJvbGU6IGN0eC51c2VyUm9sZSxcbiAvLyAgIH0pKVxuIC8vICAgLmJlZm9yZVVwbG9hZCgoKSA9PiB7XG4gLy8gICAgIHJldHVybiB0cnVlO1xuIC8vICAgfSk7XG4gLy8gY29uc3QgYSA9IGVzLmltYWdlQnVja2V0KClcbiAvLyAgIC5pbnB1dCh6Lm9iamVjdCh7IHR5cGU6IHouc3RyaW5nKCksIHNvbWVNZXRhOiB6LnN0cmluZygpLm9wdGlvbmFsKCkgfSkpXG4gLy8gICAucGF0aCgoeyBjdHgsIGlucHV0IH0pID0+IFt7IGF1dGhvcjogY3R4LnVzZXJJZCB9LCB7IHR5cGU6IGlucHV0LnR5cGUgfV0pXG4gLy8gICAubWV0YWRhdGEoKHsgY3R4LCBpbnB1dCB9KSA9PiAoe1xuIC8vICAgICByb2xlOiBjdHgudXNlclJvbGUsXG4gLy8gICAgIHNvbWVNZXRhOiBpbnB1dC5zb21lTWV0YSxcbiAvLyAgIH0pKVxuIC8vICAgLmFjY2Vzc0NvbnRyb2woe1xuIC8vICAgICBPUjogW1xuIC8vICAgICAgIHtcbiAvLyAgICAgICAgIHVzZXJJZDogeyBwYXRoOiAnYXV0aG9yJyB9LCAvLyB0aGlzIHdpbGwgY2hlY2sgaWYgdGhlIHVzZXJJZCBpcyB0aGUgc2FtZSBhcyB0aGUgYXV0aG9yIGluIHRoZSBwYXRoIHBhcmFtZXRlclxuIC8vICAgICAgIH0sXG4gLy8gICAgICAge1xuIC8vICAgICAgICAgdXNlclJvbGU6ICdhZG1pbicsIC8vIHRoaXMgaXMgdGhlIHNhbWUgYXMgeyB1c2VyUm9sZTogeyBlcTogXCJhZG1pblwiIH0gfVxuIC8vICAgICAgIH0sXG4gLy8gICAgIF0sXG4gLy8gICB9KVxuIC8vICAgLmJlZm9yZVVwbG9hZCgoeyBjdHgsIGlucHV0IH0pID0+IHtcbiAvLyAgICAgcmV0dXJuIHRydWU7XG4gLy8gICB9KVxuIC8vICAgLmJlZm9yZURlbGV0ZSgoeyBjdHgsIGZpbGUgfSkgPT4ge1xuIC8vICAgICByZXR1cm4gdHJ1ZTtcbiAvLyAgIH0pO1xuIC8vIGNvbnN0IGIgPSBlcy5pbWFnZUJ1Y2tldCgpLnBhdGgoKHsgY3R4IH0pID0+IFt7IGF1dGhvcjogY3R4LnVzZXJJZCB9XSk7XG4gLy8gY29uc3Qgcm91dGVyID0gZXMucm91dGVyKHtcbiAvLyAgIG9yaWdpbmFsOiBpbWFnZXNCdWNrZXQsXG4gLy8gICBpbWFnZUJ1Y2tldDogYSxcbiAvLyAgIGltYWdlQnVja2V0MjogYixcbiAvLyB9KTtcbiAvLyBleHBvcnQgeyByb3V0ZXIgfTtcbiAvLyB0eXBlIExpc3RGaWxlc1Jlc3BvbnNlPFRCdWNrZXQgZXh0ZW5kcyBBbnlSb3V0ZXJbJ2J1Y2tldHMnXVtzdHJpbmddPiA9IHtcbiAvLyAgIGRhdGE6IHtcbiAvLyAgICAgLy8gdXJsOiBzdHJpbmc7XG4gLy8gICAgIC8vIHNpemU6IG51bWJlcjtcbiAvLyAgICAgLy8gdXBsb2FkZWRBdDogRGF0ZTtcbiAvLyAgICAgLy8gbWV0YWRhdGE6IEluZmVyTWV0YWRhdGFPYmplY3Q8VEJ1Y2tldD47XG4gLy8gICAgIHBhdGg6IEluZmVyQnVja2V0UGF0aEtleXM8VEJ1Y2tldD4gZXh0ZW5kcyBzdHJpbmcgPyB7XG4gLy8gICAgICAgW2tleTogc3RyaW5nXTogc3RyaW5nO1xuIC8vICAgICB9IDp7XG4gLy8gICAgICAgW1RLZXkgaW4gSW5mZXJCdWNrZXRQYXRoS2V5czxUQnVja2V0Pl06IHN0cmluZztcbiAvLyAgICAgfTtcbiAvLyAgIH1bXTtcbiAvLyAgIHBhZ2luYXRpb246IHtcbiAvLyAgICAgY3VycmVudFBhZ2U6IG51bWJlcjtcbiAvLyAgICAgdG90YWxQYWdlczogbnVtYmVyO1xuIC8vICAgICB0b3RhbENvdW50OiBudW1iZXI7XG4gLy8gICB9O1xuIC8vIH07XG4gLy8gdHlwZSBUUGF0aEtleXMgPSAnYXV0aG9yJyB8ICd0eXBlJztcbiAvLyB0eXBlIFRQYXRoS2V5czIgPSBJbmZlckJ1Y2tldFBhdGhLZXlzPEFueUJ1aWxkZXI+O1xuIC8vIHR5cGUgT2JqZWN0V2l0aEtleXM8VEtleXMgZXh0ZW5kcyBzdHJpbmc+ID0ge1xuIC8vICAgW1RLZXkgaW4gVEtleXNdOiBzdHJpbmc7XG4gLy8gfTtcbiAvLyB0eXBlIFRlc3QxID0gT2JqZWN0V2l0aEtleXM8VFBhdGhLZXlzPjtcbiAvLyB0eXBlIFRlc3QyID0gT2JqZWN0V2l0aEtleXM8VFBhdGhLZXlzMj47XG4gLy8gdHlwZSBQYXRoS2V5cyA9IEluZmVyQnVja2V0UGF0aEtleXM8dHlwZW9mIHJvdXRlci5idWNrZXRzLmltYWdlQnVja2V0PjtcbiAvLyB0eXBlIE1ldGFkYXRhS2V5cyA9IEluZmVyTWV0YWRhdGFPYmplY3Q8dHlwZW9mIHJvdXRlci5idWNrZXRzLmltYWdlQnVja2V0PjtcbiAvLyB0eXBlIE15RWRnZVN0b3JlUm91dGVyID0gdHlwZW9mIHJvdXRlcjtcbiAvLyB0eXBlIE15QWNjZXNzQ29udHJvbCA9IEFjY2Vzc0NvbnRyb2xTY2hlbWE8Q29udGV4dCwgQW55RGVmPjtcblxuZXhwb3J0IHsgaW5pdEVkZ2VTdG9yZSB9O1xuIl0sIm5hbWVzIjpbInoiLCJjcmVhdGVQYXRoUGFyYW1Qcm94eSIsImdldFBhdGgiLCJ0YXJnZXQiLCJfcHJvcCIsInByb3h5RnVuY3Rpb24iLCJQcm94eSIsImdldCIsIl90YXJnZXQiLCJwcm9wQ2hpbGQiLCJTdHJpbmciLCJwcm9wIiwiY3JlYXRlTmV3QnVpbGRlciIsImluaXREZWYiLCJuZXdEZWYiLCJtZXJnZWREZWYiLCJjcmVhdGVCdWlsZGVyIiwidHlwZSIsIm9wdHMiLCJfZGVmIiwiaW5wdXQiLCJuZXZlciIsInBhdGgiLCJtZXRhZGF0YSIsIiRjb25maWciLCJjdHgiLCJ1bmRlZmluZWQiLCJwYXRoUmVzb2x2ZXIiLCJwYXRoUGFyYW1Qcm94eSIsInBhcmFtcyIsImFjY2Vzc0NvbnRyb2wiLCJiZWZvcmVVcGxvYWQiLCJiZWZvcmVEZWxldGUiLCJFZGdlU3RvcmVCdWlsZGVyIiwiY29udGV4dCIsImNyZWF0ZSIsImNyZWF0ZUVkZ2VTdG9yZUlubmVyIiwiY3JlYXRlUm91dGVyRmFjdG9yeSIsImNyZWF0ZVJvdXRlcklubmVyIiwiYnVja2V0cyIsImluaXRCdWNrZXQiLCJjb25maWciLCJidWNrZXRDb25maWciLCJpbml0RWRnZVN0b3JlSW5uZXIiLCJpbWFnZUJ1Y2tldCIsImZpbGVCdWNrZXQiLCJyb3V0ZXIiLCJpbml0RWRnZVN0b3JlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@edgestore/server/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@edgestore/server/dist/providers/edgestore/index.mjs":
/*!***************************************************************************!*\
  !*** ./node_modules/@edgestore/server/dist/providers/edgestore/index.mjs ***!
  \***************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EdgeStoreProvider: () => (/* binding */ EdgeStoreProvider)\n/* harmony export */ });\n/* harmony import */ var _index_30a3741e_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../index-30a3741e.mjs */ \"(rsc)/./node_modules/@edgestore/server/dist/index-30a3741e.mjs\");\n\nconst DEFAULT_BASE_URL = \"https://files.edgestore.dev\";\nfunction EdgeStoreProvider(options) {\n    const { accessKey = process.env.EDGE_STORE_ACCESS_KEY, secretKey = process.env.EDGE_STORE_SECRET_KEY } = options ?? {};\n    const baseUrl = process.env.EDGE_STORE_BASE_URL ?? DEFAULT_BASE_URL;\n    if (!accessKey || !secretKey) {\n        throw new _index_30a3741e_mjs__WEBPACK_IMPORTED_MODULE_0__.E();\n    }\n    const edgeStoreSdk = (0,_index_30a3741e_mjs__WEBPACK_IMPORTED_MODULE_0__.i)({\n        accessKey,\n        secretKey\n    });\n    return {\n        init: async ({ ctx, router })=>{\n            const token = await edgeStoreSdk.getToken({\n                ctx,\n                router\n            });\n            return {\n                token\n            };\n        },\n        getBaseUrl () {\n            return baseUrl;\n        },\n        getFile: async ({ url })=>{\n            const { uploadedAt, ...rest } = await edgeStoreSdk.getFile({\n                url\n            });\n            return {\n                uploadedAt: new Date(uploadedAt),\n                ...rest\n            };\n        },\n        async requestUpload ({ bucketName, bucketType, fileInfo }) {\n            // multipart upload if file is bigger than a certain size\n            const MULTIPART_THRESHOLD = 10 * 1024 * 1024; // 10MB\n            let partSize = 5 * 1024 * 1024; // 5MB\n            if (fileInfo.size > MULTIPART_THRESHOLD) {\n                let totalParts = Math.ceil(fileInfo.size / partSize);\n                if (totalParts > 1000) {\n                    // the maximum number of parts is 1000\n                    totalParts = 1000;\n                    partSize = Math.ceil(fileInfo.size / totalParts);\n                }\n                const res = await edgeStoreSdk.requestUpload({\n                    bucketName,\n                    bucketType,\n                    fileInfo,\n                    multipart: {\n                        parts: Array.from({\n                            length: totalParts\n                        }).map((_, index)=>index + 1)\n                    }\n                });\n                const multipart = res.multipart ? {\n                    key: res.multipart.key,\n                    uploadId: res.multipart.uploadId,\n                    parts: res.multipart.parts.map((part)=>({\n                            partNumber: part.partNumber,\n                            uploadUrl: part.signedUrl\n                        })),\n                    partSize,\n                    totalParts\n                } : undefined;\n                if (multipart) {\n                    return {\n                        accessUrl: res.accessUrl,\n                        thumbnailUrl: res.thumbnailUrl,\n                        multipart\n                    };\n                } else if (res.signedUrl) {\n                    return {\n                        accessUrl: res.accessUrl,\n                        uploadUrl: res.signedUrl,\n                        thumbnailUrl: res.thumbnailUrl\n                    };\n                } else {\n                    throw new Error(\"Could not get upload url\");\n                }\n            }\n            const res = await edgeStoreSdk.requestUpload({\n                bucketName,\n                bucketType,\n                fileInfo\n            });\n            if (res.signedUrl) {\n                return {\n                    accessUrl: res.accessUrl,\n                    uploadUrl: res.signedUrl,\n                    thumbnailUrl: res.thumbnailUrl\n                };\n            }\n            throw new Error(\"Could not get upload url\");\n        },\n        requestUploadParts: async ({ multipart, path })=>{\n            const res = await edgeStoreSdk.requestUploadParts({\n                multipart,\n                key: path\n            });\n            return {\n                multipart: {\n                    uploadId: res.multipart.uploadId,\n                    parts: res.multipart.parts.map((part)=>({\n                            partNumber: part.partNumber,\n                            uploadUrl: part.signedUrl\n                        }))\n                }\n            };\n        },\n        completeMultipartUpload: async ({ uploadId, key, parts })=>{\n            return await edgeStoreSdk.completeMultipartUpload({\n                uploadId,\n                key,\n                parts\n            });\n        },\n        confirmUpload: async ({ url })=>{\n            return await edgeStoreSdk.confirmUpload({\n                url\n            });\n        },\n        deleteFile: async ({ url })=>{\n            return await edgeStoreSdk.deleteFile({\n                url\n            });\n        }\n    };\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9wcm92aWRlcnMvZWRnZXN0b3JlL2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFpRztBQUVqRyxNQUFNSSxtQkFBbUI7QUFDekIsU0FBU0Msa0JBQWtCQyxPQUFPO0lBQzlCLE1BQU0sRUFBRUMsWUFBWUMsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUIsRUFBRUMsWUFBWUgsUUFBUUMsR0FBRyxDQUFDRyxxQkFBcUIsRUFBRSxHQUFHTixXQUFXLENBQUM7SUFDckgsTUFBTU8sVUFBVUwsUUFBUUMsR0FBRyxDQUFDSyxtQkFBbUIsSUFBSVY7SUFDbkQsSUFBSSxDQUFDRyxhQUFhLENBQUNJLFdBQVc7UUFDMUIsTUFBTSxJQUFJVixrREFBeUJBO0lBQ3ZDO0lBQ0EsTUFBTWMsZUFBZVosc0RBQWdCQSxDQUFDO1FBQ2xDSTtRQUNBSTtJQUNKO0lBQ0EsT0FBTztRQUNISyxNQUFNLE9BQU8sRUFBRUMsR0FBRyxFQUFFQyxNQUFNLEVBQUU7WUFDeEIsTUFBTUMsUUFBUSxNQUFNSixhQUFhSyxRQUFRLENBQUM7Z0JBQ3RDSDtnQkFDQUM7WUFDSjtZQUNBLE9BQU87Z0JBQ0hDO1lBQ0o7UUFDSjtRQUNBRTtZQUNJLE9BQU9SO1FBQ1g7UUFDQVMsU0FBUyxPQUFPLEVBQUVDLEdBQUcsRUFBRTtZQUNuQixNQUFNLEVBQUVDLFVBQVUsRUFBRSxHQUFHQyxNQUFNLEdBQUcsTUFBTVYsYUFBYU8sT0FBTyxDQUFDO2dCQUN2REM7WUFDSjtZQUNBLE9BQU87Z0JBQ0hDLFlBQVksSUFBSUUsS0FBS0Y7Z0JBQ3JCLEdBQUdDLElBQUk7WUFDWDtRQUNKO1FBQ0EsTUFBTUUsZUFBZSxFQUFFQyxVQUFVLEVBQUVDLFVBQVUsRUFBRUMsUUFBUSxFQUFFO1lBQ3JELHlEQUF5RDtZQUN6RCxNQUFNQyxzQkFBc0IsS0FBSyxPQUFPLE1BQU0sT0FBTztZQUNyRCxJQUFJQyxXQUFXLElBQUksT0FBTyxNQUFNLE1B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ZS9zZXJ2ZXIvZGlzdC9wcm92aWRlcnMvZWRnZXN0b3JlL2luZGV4Lm1qcz9iMzdkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEUgYXMgRWRnZVN0b3JlQ3JlZGVudGlhbHNFcnJvciwgaSBhcyBpbml0RWRnZVN0b3JlU2RrIH0gZnJvbSAnLi4vLi4vaW5kZXgtMzBhMzc0MWUubWpzJztcblxuY29uc3QgREVGQVVMVF9CQVNFX1VSTCA9ICdodHRwczovL2ZpbGVzLmVkZ2VzdG9yZS5kZXYnO1xuZnVuY3Rpb24gRWRnZVN0b3JlUHJvdmlkZXIob3B0aW9ucykge1xuICAgIGNvbnN0IHsgYWNjZXNzS2V5ID0gcHJvY2Vzcy5lbnYuRURHRV9TVE9SRV9BQ0NFU1NfS0VZLCBzZWNyZXRLZXkgPSBwcm9jZXNzLmVudi5FREdFX1NUT1JFX1NFQ1JFVF9LRVkgfSA9IG9wdGlvbnMgPz8ge307XG4gICAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52LkVER0VfU1RPUkVfQkFTRV9VUkwgPz8gREVGQVVMVF9CQVNFX1VSTDtcbiAgICBpZiAoIWFjY2Vzc0tleSB8fCAhc2VjcmV0S2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVDcmVkZW50aWFsc0Vycm9yKCk7XG4gICAgfVxuICAgIGNvbnN0IGVkZ2VTdG9yZVNkayA9IGluaXRFZGdlU3RvcmVTZGsoe1xuICAgICAgICBhY2Nlc3NLZXksXG4gICAgICAgIHNlY3JldEtleVxuICAgIH0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGluaXQ6IGFzeW5jICh7IGN0eCwgcm91dGVyIH0pPT57XG4gICAgICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGVkZ2VTdG9yZVNkay5nZXRUb2tlbih7XG4gICAgICAgICAgICAgICAgY3R4LFxuICAgICAgICAgICAgICAgIHJvdXRlclxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRva2VuXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBnZXRCYXNlVXJsICgpIHtcbiAgICAgICAgICAgIHJldHVybiBiYXNlVXJsO1xuICAgICAgICB9LFxuICAgICAgICBnZXRGaWxlOiBhc3luYyAoeyB1cmwgfSk9PntcbiAgICAgICAgICAgIGNvbnN0IHsgdXBsb2FkZWRBdCwgLi4ucmVzdCB9ID0gYXdhaXQgZWRnZVN0b3JlU2RrLmdldEZpbGUoe1xuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKHVwbG9hZGVkQXQpLFxuICAgICAgICAgICAgICAgIC4uLnJlc3RcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHJlcXVlc3RVcGxvYWQgKHsgYnVja2V0TmFtZSwgYnVja2V0VHlwZSwgZmlsZUluZm8gfSkge1xuICAgICAgICAgICAgLy8gbXVsdGlwYXJ0IHVwbG9hZCBpZiBmaWxlIGlzIGJpZ2dlciB0aGFuIGEgY2VydGFpbiBzaXplXG4gICAgICAgICAgICBjb25zdCBNVUxUSVBBUlRfVEhSRVNIT0xEID0gMTAgKiAxMDI0ICogMTAyNDsgLy8gMTBNQlxuICAgICAgICAgICAgbGV0IHBhcnRTaXplID0gNSAqIDEwMjQgKiAxMDI0OyAvLyA1TUJcbiAgICAgICAgICAgIGlmIChmaWxlSW5mby5zaXplID4gTVVMVElQQVJUX1RIUkVTSE9MRCkge1xuICAgICAgICAgICAgICAgIGxldCB0b3RhbFBhcnRzID0gTWF0aC5jZWlsKGZpbGVJbmZvLnNpemUgLyBwYXJ0U2l6ZSk7XG4gICAgICAgICAgICAgICAgaWYgKHRvdGFsUGFydHMgPiAxMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBtYXhpbXVtIG51bWJlciBvZiBwYXJ0cyBpcyAxMDAwXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsUGFydHMgPSAxMDAwO1xuICAgICAgICAgICAgICAgICAgICBwYXJ0U2l6ZSA9IE1hdGguY2VpbChmaWxlSW5mby5zaXplIC8gdG90YWxQYXJ0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGVkZ2VTdG9yZVNkay5yZXF1ZXN0VXBsb2FkKHtcbiAgICAgICAgICAgICAgICAgICAgYnVja2V0TmFtZSxcbiAgICAgICAgICAgICAgICAgICAgYnVja2V0VHlwZSxcbiAgICAgICAgICAgICAgICAgICAgZmlsZUluZm8sXG4gICAgICAgICAgICAgICAgICAgIG11bHRpcGFydDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydHM6IEFycmF5LmZyb20oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxlbmd0aDogdG90YWxQYXJ0c1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkubWFwKChfLCBpbmRleCk9PmluZGV4ICsgMSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IG11bHRpcGFydCA9IHJlcy5tdWx0aXBhcnQgPyB7XG4gICAgICAgICAgICAgICAgICAgIGtleTogcmVzLm11bHRpcGFydC5rZXksXG4gICAgICAgICAgICAgICAgICAgIHVwbG9hZElkOiByZXMubXVsdGlwYXJ0LnVwbG9hZElkLFxuICAgICAgICAgICAgICAgICAgICBwYXJ0czogcmVzLm11bHRpcGFydC5wYXJ0cy5tYXAoKHBhcnQpPT4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnROdW1iZXI6IHBhcnQucGFydE51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGxvYWRVcmw6IHBhcnQuc2lnbmVkVXJsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSksXG4gICAgICAgICAgICAgICAgICAgIHBhcnRTaXplLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbFBhcnRzXG4gICAgICAgICAgICAgICAgfSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAobXVsdGlwYXJ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2Nlc3NVcmw6IHJlcy5hY2Nlc3NVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6IHJlcy50aHVtYm5haWxVcmwsXG4gICAgICAgICAgICAgICAgICAgICAgICBtdWx0aXBhcnRcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5zaWduZWRVcmwpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY2Vzc1VybDogcmVzLmFjY2Vzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZFVybDogcmVzLnNpZ25lZFVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbFVybDogcmVzLnRodW1ibmFpbFVybFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGdldCB1cGxvYWQgdXJsJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZWRnZVN0b3JlU2RrLnJlcXVlc3RVcGxvYWQoe1xuICAgICAgICAgICAgICAgIGJ1Y2tldE5hbWUsXG4gICAgICAgICAgICAgICAgYnVja2V0VHlwZSxcbiAgICAgICAgICAgICAgICBmaWxlSW5mb1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmVzLnNpZ25lZFVybCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1VybDogcmVzLmFjY2Vzc1VybCxcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkVXJsOiByZXMuc2lnbmVkVXJsLFxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWxVcmw6IHJlcy50aHVtYm5haWxVcmxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDb3VsZCBub3QgZ2V0IHVwbG9hZCB1cmwnKTtcbiAgICAgICAgfSxcbiAgICAgICAgcmVxdWVzdFVwbG9hZFBhcnRzOiBhc3luYyAoeyBtdWx0aXBhcnQsIHBhdGggfSk9PntcbiAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGVkZ2VTdG9yZVNkay5yZXF1ZXN0VXBsb2FkUGFydHMoe1xuICAgICAgICAgICAgICAgIG11bHRpcGFydCxcbiAgICAgICAgICAgICAgICBrZXk6IHBhdGhcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtdWx0aXBhcnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkSWQ6IHJlcy5tdWx0aXBhcnQudXBsb2FkSWQsXG4gICAgICAgICAgICAgICAgICAgIHBhcnRzOiByZXMubXVsdGlwYXJ0LnBhcnRzLm1hcCgocGFydCk9Pih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFydE51bWJlcjogcGFydC5wYXJ0TnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZFVybDogcGFydC5zaWduZWRVcmxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkOiBhc3luYyAoeyB1cGxvYWRJZCwga2V5LCBwYXJ0cyB9KT0+e1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGVkZ2VTdG9yZVNkay5jb21wbGV0ZU11bHRpcGFydFVwbG9hZCh7XG4gICAgICAgICAgICAgICAgdXBsb2FkSWQsXG4gICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgIHBhcnRzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgY29uZmlybVVwbG9hZDogYXN5bmMgKHsgdXJsIH0pPT57XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRnZVN0b3JlU2RrLmNvbmZpcm1VcGxvYWQoe1xuICAgICAgICAgICAgICAgIHVybFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUZpbGU6IGFzeW5jICh7IHVybCB9KT0+e1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IGVkZ2VTdG9yZVNkay5kZWxldGVGaWxlKHtcbiAgICAgICAgICAgICAgICB1cmxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuZXhwb3J0IHsgRWRnZVN0b3JlUHJvdmlkZXIgfTtcbiJdLCJuYW1lcyI6WyJFIiwiRWRnZVN0b3JlQ3JlZGVudGlhbHNFcnJvciIsImkiLCJpbml0RWRnZVN0b3JlU2RrIiwiREVGQVVMVF9CQVNFX1VSTCIsIkVkZ2VTdG9yZVByb3ZpZGVyIiwib3B0aW9ucyIsImFjY2Vzc0tleSIsInByb2Nlc3MiLCJlbnYiLCJFREdFX1NUT1JFX0FDQ0VTU19LRVkiLCJzZWNyZXRLZXkiLCJFREdFX1NUT1JFX1NFQ1JFVF9LRVkiLCJiYXNlVXJsIiwiRURHRV9TVE9SRV9CQVNFX1VSTCIsImVkZ2VTdG9yZVNkayIsImluaXQiLCJjdHgiLCJyb3V0ZXIiLCJ0b2tlbiIsImdldFRva2VuIiwiZ2V0QmFzZVVybCIsImdldEZpbGUiLCJ1cmwiLCJ1cGxvYWRlZEF0IiwicmVzdCIsIkRhdGUiLCJyZXF1ZXN0VXBsb2FkIiwiYnVja2V0TmFtZSIsImJ1Y2tldFR5cGUiLCJmaWxlSW5mbyIsIk1VTFRJUEFSVF9USFJFU0hPTEQiLCJwYXJ0U2l6ZSIsInNpemUiLCJ0b3RhbFBhcnRzIiwiTWF0aCIsImNlaWwiLCJyZXMiLCJtdWx0aXBhcnQiLCJwYXJ0cyIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIm1hcCIsIl8iLCJpbmRleCIsImtleSIsInVwbG9hZElkIiwicGFydCIsInBhcnROdW1iZXIiLCJ1cGxvYWRVcmwiLCJzaWduZWRVcmwiLCJ1bmRlZmluZWQiLCJhY2Nlc3NVcmwiLCJ0aHVtYm5haWxVcmwiLCJFcnJvciIsInJlcXVlc3RVcGxvYWRQYXJ0cyIsInBhdGgiLCJjb21wbGV0ZU11bHRpcGFydFVwbG9hZCIsImNvbmZpcm1VcGxvYWQiLCJkZWxldGVGaWxlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@edgestore/server/dist/providers/edgestore/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/@edgestore/server/dist/shared-6dea9e91.mjs":
/*!*****************************************************************!*\
  !*** ./node_modules/@edgestore/server/dist/shared-6dea9e91.mjs ***!
  \*****************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: () => (/* binding */ EdgeStoreError),\n/* harmony export */   a: () => (/* binding */ requestUploadParts),\n/* harmony export */   b: () => (/* binding */ confirmUpload),\n/* harmony export */   c: () => (/* binding */ completeMultipartUpload),\n/* harmony export */   d: () => (/* binding */ deleteFile),\n/* harmony export */   e: () => (/* binding */ EDGE_STORE_ERROR_CODES),\n/* harmony export */   i: () => (/* binding */ init),\n/* harmony export */   r: () => (/* binding */ requestUpload)\n/* harmony export */ });\n/* harmony import */ var _panva_hkdf__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @panva/hkdf */ \"(rsc)/./node_modules/@panva/hkdf/dist/node/esm/index.js\");\n/* harmony import */ var cookie__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! cookie */ \"(rsc)/./node_modules/cookie/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/jose/dist/node/esm/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"(rsc)/./node_modules/uuid/dist/esm-node/v4.js\");\n/* harmony import */ var _swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @swc/helpers/_/_define_property */ \"(rsc)/./node_modules/@swc/helpers/cjs/_define_property.cjs\");\n\n\n\n\n\nconst EDGE_STORE_ERROR_CODES = {\n    BAD_REQUEST: 400,\n    UNAUTHORIZED: 401\n};\nclass EdgeStoreError extends Error {\n    constructor(opts){\n        super(opts.message);\n        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, \"cause\", void 0);\n        (0,_swc_helpers_define_property__WEBPACK_IMPORTED_MODULE_3__._)(this, \"code\", void 0);\n        this.name = \"EdgeStoreError\";\n        this.code = opts.code;\n        this.cause = opts.cause;\n    }\n}\nconst IMAGE_MIME_TYPES = [\n    \"image/jpeg\",\n    \"image/png\",\n    \"image/gif\",\n    \"image/webp\",\n    \"image/svg+xml\",\n    \"image/tiff\",\n    \"image/bmp\",\n    \"image/x-icon\"\n];\n// TODO: change it to 1 hour when we have a way to refresh the token\nconst DEFAULT_MAX_AGE = 30 * 24 * 60 * 60; // 30 days\nasync function init(params) {\n    const { ctx, provider, router } = params;\n    const ctxToken = await encryptJWT(ctx);\n    const { token } = await provider.init({\n        ctx,\n        router: router\n    });\n    const newCookies = [\n        (0,cookie__WEBPACK_IMPORTED_MODULE_1__.serialize)(\"edgestore-ctx\", ctxToken, {\n            path: \"/\",\n            maxAge: DEFAULT_MAX_AGE\n        })\n    ];\n    if (token) {\n        newCookies.push((0,cookie__WEBPACK_IMPORTED_MODULE_1__.serialize)(\"edgestore-token\", token, {\n            path: \"/\",\n            maxAge: DEFAULT_MAX_AGE\n        }));\n    }\n    const baseUrl = await provider.getBaseUrl();\n    return {\n        newCookies,\n        token,\n        baseUrl\n    };\n}\nasync function requestUpload(params) {\n    const { provider, router, ctxToken, body: { bucketName, input, fileInfo } } = params;\n    if (!ctxToken) {\n        throw new EdgeStoreError({\n            message: \"Missing edgestore-ctx cookie\",\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    const ctx = await getContext(ctxToken);\n    const bucket = router.buckets[bucketName];\n    if (!bucket) {\n        throw new Error(`Bucket ${bucketName} not found`);\n    }\n    if (bucket._def.beforeUpload) {\n        const canUpload = await bucket._def.beforeUpload?.({\n            ctx,\n            input,\n            fileInfo: {\n                size: fileInfo.size,\n                type: fileInfo.type,\n                fileName: fileInfo.fileName,\n                extension: fileInfo.extension,\n                replaceTargetUrl: fileInfo.replaceTargetUrl,\n                temporary: fileInfo.temporary\n            }\n        });\n        if (!canUpload) {\n            throw new Error(\"Upload not allowed\");\n        }\n    }\n    if (bucket._def.type === \"IMAGE\") {\n        if (!IMAGE_MIME_TYPES.includes(fileInfo.type)) {\n            throw new EdgeStoreError({\n                code: \"BAD_REQUEST\",\n                message: \"Only images are allowed in this bucket\"\n            });\n        }\n    }\n    if (bucket._def.bucketConfig?.maxSize) {\n        if (fileInfo.size > bucket._def.bucketConfig.maxSize) {\n            throw new EdgeStoreError({\n                code: \"BAD_REQUEST\",\n                message: `File size is too big. Max size is ${bucket._def.bucketConfig.maxSize}`\n            });\n        }\n    }\n    if (bucket._def.bucketConfig?.accept) {\n        const accept = bucket._def.bucketConfig.accept;\n        let accepted = false;\n        for (const acceptedMimeType of accept){\n            if (acceptedMimeType.endsWith(\"/*\")) {\n                const mimeType = acceptedMimeType.replace(\"/*\", \"\");\n                if (fileInfo.type.startsWith(mimeType)) {\n                    accepted = true;\n                    break;\n                }\n            } else if (fileInfo.type === acceptedMimeType) {\n                accepted = true;\n                break;\n            }\n        }\n        if (!accepted) {\n            throw new EdgeStoreError({\n                code: \"BAD_REQUEST\",\n                message: `\"${fileInfo.type}\" is not allowed. Accepted types are ${JSON.stringify(accept)}`\n            });\n        }\n    }\n    const path = buildPath({\n        fileInfo,\n        bucket,\n        pathAttrs: {\n            ctx,\n            input\n        }\n    });\n    const metadata = await bucket._def.metadata?.({\n        ctx,\n        input\n    });\n    const isPublic = bucket._def.accessControl === undefined;\n    const requestUploadRes = await provider.requestUpload({\n        bucketName,\n        bucketType: bucket._def.type,\n        fileInfo: {\n            ...fileInfo,\n            path,\n            isPublic,\n            metadata\n        }\n    });\n    const parsedPath = path.reduce((acc, curr)=>{\n        acc[curr.key] = curr.value;\n        return acc;\n    }, {});\n    const pathOrder = path.map((p)=>p.key);\n    return {\n        ...requestUploadRes,\n        size: fileInfo.size,\n        uploadedAt: new Date().toISOString(),\n        path: parsedPath,\n        pathOrder,\n        metadata\n    };\n}\nasync function requestUploadParts(params) {\n    const { provider, router, ctxToken, body: { multipart, path } } = params;\n    if (!ctxToken) {\n        throw new EdgeStoreError({\n            message: \"Missing edgestore-ctx cookie\",\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    await getContext(ctxToken); // just to check if the token is valid\n    const bucket = router.buckets[multipart.uploadId];\n    if (!bucket) {\n        throw new Error(`Bucket ${multipart.uploadId} not found`);\n    }\n    return await provider.requestUploadParts({\n        multipart,\n        path\n    });\n}\nasync function completeMultipartUpload(params) {\n    const { provider, router, ctxToken, body: { bucketName, uploadId, key, parts } } = params;\n    if (!ctxToken) {\n        throw new EdgeStoreError({\n            message: \"Missing edgestore-ctx cookie\",\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    await getContext(ctxToken); // just to check if the token is valid\n    const bucket = router.buckets[bucketName];\n    if (!bucket) {\n        throw new Error(`Bucket ${bucketName} not found`);\n    }\n    return await provider.completeMultipartUpload({\n        uploadId,\n        key,\n        parts\n    });\n}\nasync function confirmUpload(params) {\n    const { provider, router, ctxToken, body: { bucketName, url } } = params;\n    if (!ctxToken) {\n        throw new EdgeStoreError({\n            message: \"Missing edgestore-ctx cookie\",\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    await getContext(ctxToken); // just to check if the token is valid\n    const bucket = router.buckets[bucketName];\n    if (!bucket) {\n        throw new Error(`Bucket ${bucketName} not found`);\n    }\n    return await provider.confirmUpload({\n        bucket,\n        url: unproxyUrl(url)\n    });\n}\nasync function deleteFile(params) {\n    const { provider, router, ctxToken, body: { bucketName, url } } = params;\n    if (!ctxToken) {\n        throw new EdgeStoreError({\n            message: \"Missing edgestore-ctx cookie\",\n            code: \"UNAUTHORIZED\"\n        });\n    }\n    const ctx = await getContext(ctxToken);\n    const bucket = router.buckets[bucketName];\n    if (!bucket) {\n        throw new Error(`Bucket ${bucketName} not found`);\n    }\n    if (!bucket._def.beforeDelete) {\n        throw new Error(\"You need to define beforeDelete if you want to delete files directly from the frontend.\");\n    }\n    const fileInfo = await provider.getFile({\n        url\n    });\n    const canDelete = await bucket._def.beforeDelete({\n        ctx,\n        fileInfo\n    });\n    if (!canDelete) {\n        throw new Error(\"Delete not allowed\");\n    }\n    return await provider.deleteFile({\n        bucket,\n        url: unproxyUrl(url)\n    });\n}\nasync function encryptJWT(ctx) {\n    const secret = process.env.EDGE_STORE_JWT_SECRET ?? process.env.EDGE_STORE_SECRET_KEY;\n    if (!secret) {\n        throw new Error(\"EDGE_STORE_JWT_SECRET or EDGE_STORE_SECRET_KEY is not defined\");\n    }\n    const encryptionSecret = await getDerivedEncryptionKey(secret);\n    return await new jose__WEBPACK_IMPORTED_MODULE_2__.EncryptJWT(ctx).setProtectedHeader({\n        alg: \"dir\",\n        enc: \"A256GCM\"\n    }).setIssuedAt().setExpirationTime(Date.now() / 1000 + DEFAULT_MAX_AGE).setJti((0,uuid__WEBPACK_IMPORTED_MODULE_4__[\"default\"])()).encrypt(encryptionSecret);\n}\nasync function decryptJWT(token) {\n    const secret = process.env.EDGE_STORE_JWT_SECRET ?? process.env.EDGE_STORE_SECRET_KEY;\n    if (!secret) {\n        throw new Error(\"EDGE_STORE_JWT_SECRET or EDGE_STORE_SECRET_KEY is not set\");\n    }\n    const encryptionSecret = await getDerivedEncryptionKey(secret);\n    const { payload } = await (0,jose__WEBPACK_IMPORTED_MODULE_2__.jwtDecrypt)(token, encryptionSecret, {\n        clockTolerance: 15\n    });\n    return payload;\n}\nasync function getDerivedEncryptionKey(secret) {\n    return await (0,_panva_hkdf__WEBPACK_IMPORTED_MODULE_0__.hkdf)(\"sha256\", secret, \"\", \"Edge Store Generated Encryption Key\", 32);\n}\nfunction buildPath(params) {\n    const { bucket } = params;\n    const pathParams = bucket._def.path;\n    const path = pathParams.map((param)=>{\n        const paramEntries = Object.entries(param);\n        if (paramEntries[0] === undefined) {\n            throw new Error(\"Missing path param\");\n        }\n        const [key, value] = paramEntries[0];\n        // this is a string like: \"ctx.xxx\" or \"input.yyy.zzz\"\n        const currParamVal = value().split(\".\").reduce((acc2, key)=>{\n            if (acc2[key] === undefined) {\n                throw new Error(`Missing key ${key} in ${JSON.stringify(acc2)}`);\n            }\n            return acc2[key];\n        }, params.pathAttrs);\n        return {\n            key,\n            value: currParamVal\n        };\n    });\n    return path;\n}\nasync function getContext(token) {\n    if (!token) {\n        throw new Error(\"No token\");\n    }\n    return await decryptJWT(token);\n}\n/**\n * On local development, protected files are proxied to the server,\n * which changes the original URL.\n *\n * This function is used to get the original URL,\n * so that we can delete or confirm the upload.\n */ function unproxyUrl(url) {\n    if ( true && url.startsWith(\"http://\")) {\n        // get the url param from the query string\n        const urlParam = new URL(url).searchParams.get(\"url\");\n        if (urlParam) {\n            return urlParam;\n        }\n    }\n    return url;\n}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvQGVkZ2VzdG9yZS9zZXJ2ZXIvZGlzdC9zaGFyZWQtNmRlYTllOTEubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBbUM7QUFDQTtBQUNXO0FBQ3BCO0FBQzBCO0FBRXBELE1BQU1NLHlCQUF5QjtJQUMzQkMsYUFBYTtJQUNiQyxjQUFjO0FBQ2xCO0FBQ0EsTUFBTUMsdUJBQXVCQztJQUN6QkMsWUFBWUMsSUFBSSxDQUFDO1FBQ2IsS0FBSyxDQUFDQSxLQUFLQyxPQUFPO1FBQ2xCUiwrREFBQ0EsQ0FBQyxJQUFJLEVBQUUsU0FBUyxLQUFLO1FBQ3RCQSwrREFBQ0EsQ0FBQyxJQUFJLEVBQUUsUUFBUSxLQUFLO1FBQ3JCLElBQUksQ0FBQ1MsSUFBSSxHQUFHO1FBQ1osSUFBSSxDQUFDQyxJQUFJLEdBQUdILEtBQUtHLElBQUk7UUFDckIsSUFBSSxDQUFDQyxLQUFLLEdBQUdKLEtBQUtJLEtBQUs7SUFDM0I7QUFDSjtBQUVBLE1BQU1DLG1CQUFtQjtJQUNyQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0g7QUFFRCxvRUFBb0U7QUFDcEUsTUFBTUMsa0JBQWtCLEtBQUssS0FBSyxLQUFLLElBQUksVUFBVTtBQUNyRCxlQUFlQyxLQUFLQyxNQUFNO0lBQ3RCLE1BQU0sRUFBRUMsR0FBRyxFQUFFQyxRQUFRLEVBQUVDLE1BQU0sRUFBRSxHQUFHSDtJQUNsQyxNQUFNSSxXQUFXLE1BQU1DLFdBQVdKO0lBQ2xDLE1BQU0sRUFBRUssS0FBSyxFQUFFLEdBQUcsTUFBTUosU0FBU0gsSUFBSSxDQUFDO1FBQ2xDRTtRQUNBRSxRQUFRQTtJQUNaO0lBQ0EsTUFBTUksYUFBYTtRQUNmMUIsaURBQVNBLENBQUMsaUJBQWlCdUIsVUFBVTtZQUNqQ0ksTUFBTTtZQUNOQyxRQUFRWDtRQUNaO0tBQ0g7SUFDRCxJQUFJUSxPQUFPO1FBQ1BDLFdBQVdHLElBQUksQ0FBQzdCLGlEQUFTQSxDQUFDLG1CQUFtQnlCLE9BQU87WUFDaERFLE1BQU07WUFDTkMsUUFBUVg7UUFDWjtJQUNKO0lBQ0EsTUFBTWEsVUFBVSxNQUFNVCxTQUFTVSxVQUFVO0lBQ3pDLE9BQU87UUFDSEw7UUFDQUQ7UUFDQUs7SUFDSjtBQUNKO0FBQ0EsZUFBZUUsY0FBY2IsTUFBTTtJQUMvQixNQUFNLEVBQUVFLFFBQVEsRUFBRUMsTUFBTSxFQUFFQyxRQUFRLEVBQUVVLE1BQU0sRUFBRUMsVUFBVSxFQUFFQyxLQUFLLEVBQUVDLFFBQVEsRUFBRSxFQUFFLEdBQUdqQjtJQUM5RSxJQUFJLENBQUNJLFVBQVU7UUFDWCxNQUFNLElBQUlmLGVBQWU7WUFDckJJLFNBQVM7WUFDVEUsTUFBTTtRQUNWO0lBQ0o7SUFDQSxNQUFNTSxNQUFNLE1BQU1pQixXQUFXZDtJQUM3QixNQUFNZSxTQUFTaEIsT0FBT2lCLE9BQU8sQ0FBQ0wsV0FBVztJQUN6QyxJQUFJLENBQUNJLFFBQVE7UUFDVCxNQUFNLElBQUk3QixNQUFNLENBQUMsT0FBTyxFQUFFeUIsV0FBVyxVQUFVLENBQUM7SUFDcEQ7SUFDQSxJQUFJSSxPQUFPRSxJQUFJLENBQUNDLFlBQVksRUFBRTtRQUMxQixNQUFNQyxZQUFZLE1BQU1KLE9BQU9FLElBQUksQ0FBQ0MsWUFBWSxHQUFHO1lBQy9DckI7WUFDQWU7WUFDQUMsVUFBVTtnQkFDTk8sTUFBTVAsU0FBU08sSUFBSTtnQkFDbkJDLE1BQU1SLFNBQVNRLElBQUk7Z0JBQ25CQyxVQUFVVCxTQUFTUyxRQUFRO2dCQUMzQkMsV0FBV1YsU0FBU1UsU0FBUztnQkFDN0JDLGtCQUFrQlgsU0FBU1csZ0JBQWdCO2dCQUMzQ0MsV0FBV1osU0FBU1ksU0FBUztZQUNqQztRQUNKO1FBQ0EsSUFBSSxDQUFDTixXQUFXO1lBQ1osTUFBTSxJQUFJakMsTUFBTTtRQUNwQjtJQUNKO0lBQ0EsSUFBSTZCLE9BQU9FLElBQUksQ0FBQ0ksSUFBSSxLQUFLLFNBQVM7UUFDOUIsSUFBSSxDQUFDNUIsaUJBQWlCaUMsUUFBUSxDQUFDYixTQUFTUSxJQUFJLEdBQUc7WUFDM0MsTUFBTSxJQUFJcEMsZUFBZTtnQkFDckJNLE1BQU07Z0JBQ05GLFNBQVM7WUFDYjtRQUNKO0lBQ0o7SUFDQSxJQUFJMEIsT0FBT0UsSUFBSSxDQUFDVSxZQUFZLEVBQUVDLFNBQVM7UUFDbkMsSUFBSWYsU0FBU08sSUFBSSxHQUFHTCxPQUFPRSxJQUFJLENBQUNVLFlBQVksQ0FBQ0MsT0FBTyxFQUFFO1lBQ2xELE1BQU0sSUFBSTNDLGVBQWU7Z0JBQ3JCTSxNQUFNO2dCQUNORixTQUFTLENBQUMsa0NBQWtDLEVBQUUwQixPQUFPRSxJQUFJLENBQUNVLFlBQVksQ0FBQ0MsT0FBTyxDQUFDLENBQUM7WUFDcEY7UUFDSjtJQUNKO0lBQ0EsSUFBSWIsT0FBT0UsSUFBSSxDQUFDVSxZQUFZLEVBQUVFLFFBQVE7UUFDbEMsTUFBTUEsU0FBU2QsT0FBT0UsSUFBSSxDQUFDVSxZQUFZLENBQUNFLE1BQU07UUFDOUMsSUFBSUMsV0FBVztRQUNmLEtBQUssTUFBTUMsb0JBQW9CRixPQUFPO1lBQ2xDLElBQUlFLGlCQUFpQkMsUUFBUSxDQUFDLE9BQU87Z0JBQ2pDLE1BQU1DLFdBQVdGLGlCQUFpQkcsT0FBTyxDQUFDLE1BQU07Z0JBQ2hELElBQUlyQixTQUFTUSxJQUFJLENBQUNjLFVBQVUsQ0FBQ0YsV0FBVztvQkFDcENILFdBQVc7b0JBQ1g7Z0JBQ0o7WUFDSixPQUFPLElBQUlqQixTQUFTUSxJQUFJLEtBQUtVLGtCQUFrQjtnQkFDM0NELFdBQVc7Z0JBQ1g7WUFDSjtRQUNKO1FBQ0EsSUFBSSxDQUFDQSxVQUFVO1lBQ1gsTUFBTSxJQUFJN0MsZUFBZTtnQkFDckJNLE1BQU07Z0JBQ05GLFNBQVMsQ0FBQyxDQUFDLEVBQUV3QixTQUFTUSxJQUFJLENBQUMscUNBQXFDLEVBQUVlLEtBQUtDLFNBQVMsQ0FBQ1IsUUFBUSxDQUFDO1lBQzlGO1FBQ0o7SUFDSjtJQUNBLE1BQU16QixPQUFPa0MsVUFBVTtRQUNuQnpCO1FBQ0FFO1FBQ0F3QixXQUFXO1lBQ1AxQztZQUNBZTtRQUNKO0lBQ0o7SUFDQSxNQUFNNEIsV0FBVyxNQUFNekIsT0FBT0UsSUFBSSxDQUFDdUIsUUFBUSxHQUFHO1FBQzFDM0M7UUFDQWU7SUFDSjtJQUNBLE1BQU02QixXQUFXMUIsT0FBT0UsSUFBSSxDQUFDeUIsYUFBYSxLQUFLQztJQUMvQyxNQUFNQyxtQkFBbUIsTUFBTTlDLFNBQVNXLGFBQWEsQ0FBQztRQUNsREU7UUFDQWtDLFlBQVk5QixPQUFPRSxJQUFJLENBQUNJLElBQUk7UUFDNUJSLFVBQVU7WUFDTixHQUFHQSxRQUFRO1lBQ1hUO1lBQ0FxQztZQUNBRDtRQUNKO0lBQ0o7SUFDQSxNQUFNTSxhQUFhMUMsS0FBSzJDLE1BQU0sQ0FBQyxDQUFDQyxLQUFLQztRQUNqQ0QsR0FBRyxDQUFDQyxLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsS0FBSztRQUMxQixPQUFPSDtJQUNYLEdBQUcsQ0FBQztJQUNKLE1BQU1JLFlBQVloRCxLQUFLaUQsR0FBRyxDQUFDLENBQUNDLElBQUlBLEVBQUVKLEdBQUc7SUFDckMsT0FBTztRQUNILEdBQUdOLGdCQUFnQjtRQUNuQnhCLE1BQU1QLFNBQVNPLElBQUk7UUFDbkJtQyxZQUFZLElBQUlDLE9BQU9DLFdBQVc7UUFDbENyRCxNQUFNMEM7UUFDTk07UUFDQVo7SUFDSjtBQUNKO0FBQ0EsZUFBZWtCLG1CQUFtQjlELE1BQU07SUFDcEMsTUFBTSxFQUFFRSxRQUFRLEVBQUVDLE1BQU0sRUFBRUMsUUFBUSxFQUFFVSxNQUFNLEVBQUVpRCxTQUFTLEVBQUV2RCxJQUFJLEVBQUUsRUFBRSxHQUFHUjtJQUNsRSxJQUFJLENBQUNJLFVBQVU7UUFDWCxNQUFNLElBQUlmLGVBQWU7WUFDckJJLFNBQVM7WUFDVEUsTUFBTTtRQUNWO0lBQ0o7SUFDQSxNQUFNdUIsV0FBV2QsV0FBVyxzQ0FBc0M7SUFDbEUsTUFBTWUsU0FBU2hCLE9BQU9pQixPQUFPLENBQUMyQyxVQUFVQyxRQUFRLENBQUM7SUFDakQsSUFBSSxDQUFDN0MsUUFBUTtRQUNULE1BQU0sSUFBSTdCLE1BQU0sQ0FBQyxPQUFPLEVBQUV5RSxVQUFVQyxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQzVEO0lBQ0EsT0FBTyxNQUFNOUQsU0FBUzRELGtCQUFrQixDQUFDO1FBQ3JDQztRQUNBdkQ7SUFDSjtBQUNKO0FBQ0EsZUFBZXlELHdCQUF3QmpFLE1BQU07SUFDekMsTUFBTSxFQUFFRSxRQUFRLEVBQUVDLE1BQU0sRUFBRUMsUUFBUSxFQUFFVSxNQUFNLEVBQUVDLFVBQVUsRUFBRWlELFFBQVEsRUFBRVYsR0FBRyxFQUFFWSxLQUFLLEVBQUUsRUFBRSxHQUFHbEU7SUFDbkYsSUFBSSxDQUFDSSxVQUFVO1FBQ1gsTUFBTSxJQUFJZixlQUFlO1lBQ3JCSSxTQUFTO1lBQ1RFLE1BQU07UUFDVjtJQUNKO0lBQ0EsTUFBTXVCLFdBQVdkLFdBQVcsc0NBQXNDO0lBQ2xFLE1BQU1lLFNBQVNoQixPQUFPaUIsT0FBTyxDQUFDTCxXQUFXO0lBQ3pDLElBQUksQ0FBQ0ksUUFBUTtRQUNULE1BQU0sSUFBSTdCLE1BQU0sQ0FBQyxPQUFPLEVBQUV5QixXQUFXLFVBQVUsQ0FBQztJQUNwRDtJQUNBLE9BQU8sTUFBTWIsU0FBUytELHVCQUF1QixDQUFDO1FBQzFDRDtRQUNBVjtRQUNBWTtJQUNKO0FBQ0o7QUFDQSxlQUFlQyxjQUFjbkUsTUFBTTtJQUMvQixNQUFNLEVBQUVFLFFBQVEsRUFBRUMsTUFBTSxFQUFFQyxRQUFRLEVBQUVVLE1BQU0sRUFBRUMsVUFBVSxFQUFFcUQsR0FBRyxFQUFFLEVBQUUsR0FBR3BFO0lBQ2xFLElBQUksQ0FBQ0ksVUFBVTtRQUNYLE1BQU0sSUFBSWYsZUFBZTtZQUNyQkksU0FBUztZQUNURSxNQUFNO1FBQ1Y7SUFDSjtJQUNBLE1BQU11QixXQUFXZCxXQUFXLHNDQUFzQztJQUNsRSxNQUFNZSxTQUFTaEIsT0FBT2lCLE9BQU8sQ0FBQ0wsV0FBVztJQUN6QyxJQUFJLENBQUNJLFFBQVE7UUFDVCxNQUFNLElBQUk3QixNQUFNLENBQUMsT0FBTyxFQUFFeUIsV0FBVyxVQUFVLENBQUM7SUFDcEQ7SUFDQSxPQUFPLE1BQU1iLFNBQVNpRSxhQUFhLENBQUM7UUFDaENoRDtRQUNBaUQsS0FBS0MsV0FBV0Q7SUFDcEI7QUFDSjtBQUNBLGVBQWVFLFdBQVd0RSxNQUFNO0lBQzVCLE1BQU0sRUFBRUUsUUFBUSxFQUFFQyxNQUFNLEVBQUVDLFFBQVEsRUFBRVUsTUFBTSxFQUFFQyxVQUFVLEVBQUVxRCxHQUFHLEVBQUUsRUFBRSxHQUFHcEU7SUFDbEUsSUFBSSxDQUFDSSxVQUFVO1FBQ1gsTUFBTSxJQUFJZixlQUFlO1lBQ3JCSSxTQUFTO1lBQ1RFLE1BQU07UUFDVjtJQUNKO0lBQ0EsTUFBTU0sTUFBTSxNQUFNaUIsV0FBV2Q7SUFDN0IsTUFBTWUsU0FBU2hCLE9BQU9pQixPQUFPLENBQUNMLFdBQVc7SUFDekMsSUFBSSxDQUFDSSxRQUFRO1FBQ1QsTUFBTSxJQUFJN0IsTUFBTSxDQUFDLE9BQU8sRUFBRXlCLFdBQVcsVUFBVSxDQUFDO0lBQ3BEO0lBQ0EsSUFBSSxDQUFDSSxPQUFPRSxJQUFJLENBQUNrRCxZQUFZLEVBQUU7UUFDM0IsTUFBTSxJQUFJakYsTUFBTTtJQUNwQjtJQUNBLE1BQU0yQixXQUFXLE1BQU1mLFNBQVNzRSxPQUFPLENBQUM7UUFDcENKO0lBQ0o7SUFDQSxNQUFNSyxZQUFZLE1BQU10RCxPQUFPRSxJQUFJLENBQUNrRCxZQUFZLENBQUM7UUFDN0N0RTtRQUNBZ0I7SUFDSjtJQUNBLElBQUksQ0FBQ3dELFdBQVc7UUFDWixNQUFNLElBQUluRixNQUFNO0lBQ3BCO0lBQ0EsT0FBTyxNQUFNWSxTQUFTb0UsVUFBVSxDQUFDO1FBQzdCbkQ7UUFDQWlELEtBQUtDLFdBQVdEO0lBQ3BCO0FBQ0o7QUFDQSxlQUFlL0QsV0FBV0osR0FBRztJQUN6QixNQUFNeUUsU0FBU0MsUUFBUUMsR0FBRyxDQUFDQyxxQkFBcUIsSUFBSUYsUUFBUUMsR0FBRyxDQUFDRSxxQkFBcUI7SUFDckYsSUFBSSxDQUFDSixRQUFRO1FBQ1QsTUFBTSxJQUFJcEYsTUFBTTtJQUNwQjtJQUNBLE1BQU15RixtQkFBbUIsTUFBTUMsd0JBQXdCTjtJQUN2RCxPQUFPLE1BQU0sSUFBSTVGLDRDQUFVQSxDQUFDbUIsS0FBS2dGLGtCQUFrQixDQUFDO1FBQ2hEQyxLQUFLO1FBQ0xDLEtBQUs7SUFDVCxHQUFHQyxXQUFXLEdBQUdDLGlCQUFpQixDQUFDekIsS0FBSzBCLEdBQUcsS0FBSyxPQUFPeEYsaUJBQWlCeUYsTUFBTSxDQUFDdkcsZ0RBQUVBLElBQUl3RyxPQUFPLENBQUNUO0FBQ2pHO0FBQ0EsZUFBZVUsV0FBV25GLEtBQUs7SUFDM0IsTUFBTW9FLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ0MscUJBQXFCLElBQUlGLFFBQVFDLEdBQUcsQ0FBQ0UscUJBQXFCO0lBQ3JGLElBQUksQ0FBQ0osUUFBUTtRQUNULE1BQU0sSUFBSXBGLE1BQU07SUFDcEI7SUFDQSxNQUFNeUYsbUJBQW1CLE1BQU1DLHdCQUF3Qk47SUFDdkQsTUFBTSxFQUFFZ0IsT0FBTyxFQUFFLEdBQUcsTUFBTTNHLGdEQUFVQSxDQUFDdUIsT0FBT3lFLGtCQUFrQjtRQUMxRFksZ0JBQWdCO0lBQ3BCO0lBQ0EsT0FBT0Q7QUFDWDtBQUNBLGVBQWVWLHdCQUF3Qk4sTUFBTTtJQUN6QyxPQUFPLE1BQU05RixpREFBSUEsQ0FBQyxVQUFVOEYsUUFBUSxJQUFJLHVDQUF1QztBQUNuRjtBQUNBLFNBQVNoQyxVQUFVMUMsTUFBTTtJQUNyQixNQUFNLEVBQUVtQixNQUFNLEVBQUUsR0FBR25CO0lBQ25CLE1BQU00RixhQUFhekUsT0FBT0UsSUFBSSxDQUFDYixJQUFJO0lBQ25DLE1BQU1BLE9BQU9vRixXQUFXbkMsR0FBRyxDQUFDLENBQUNvQztRQUN6QixNQUFNQyxlQUFlQyxPQUFPQyxPQUFPLENBQUNIO1FBQ3BDLElBQUlDLFlBQVksQ0FBQyxFQUFFLEtBQUsvQyxXQUFXO1lBQy9CLE1BQU0sSUFBSXpELE1BQU07UUFDcEI7UUFDQSxNQUFNLENBQUNnRSxLQUFLQyxNQUFNLEdBQUd1QyxZQUFZLENBQUMsRUFBRTtRQUNwQyxzREFBc0Q7UUFDdEQsTUFBTUcsZUFBZTFDLFFBQVEyQyxLQUFLLENBQUMsS0FBSy9DLE1BQU0sQ0FBQyxDQUFDZ0QsTUFBTTdDO1lBQ2xELElBQUk2QyxJQUFJLENBQUM3QyxJQUFJLEtBQUtQLFdBQVc7Z0JBQ3pCLE1BQU0sSUFBSXpELE1BQU0sQ0FBQyxZQUFZLEVBQUVnRSxJQUFJLElBQUksRUFBRWQsS0FBS0MsU0FBUyxDQUFDMEQsTUFBTSxDQUFDO1lBQ25FO1lBQ0EsT0FBT0EsSUFBSSxDQUFDN0MsSUFBSTtRQUNwQixHQUFHdEQsT0FBTzJDLFNBQVM7UUFDbkIsT0FBTztZQUNIVztZQUNBQyxPQUFPMEM7UUFDWDtJQUNKO0lBQ0EsT0FBT3pGO0FBQ1g7QUFDQSxlQUFlVSxXQUFXWixLQUFLO0lBQzNCLElBQUksQ0FBQ0EsT0FBTztRQUNSLE1BQU0sSUFBSWhCLE1BQU07SUFDcEI7SUFDQSxPQUFPLE1BQU1tRyxXQUFXbkY7QUFDNUI7QUFDQTs7Ozs7O0NBTUMsR0FBRyxTQUFTK0QsV0FBV0QsR0FBRztJQUN2QixJQUFJTyxLQUF5QixJQUFpQlAsSUFBSTdCLFVBQVUsQ0FBQyxZQUFZO1FBQ3JFLDBDQUEwQztRQUMxQyxNQUFNNkQsV0FBVyxJQUFJQyxJQUFJakMsS0FBS2tDLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1FBQy9DLElBQUlILFVBQVU7WUFDVixPQUFPQTtRQUNYO0lBQ0o7SUFDQSxPQUFPaEM7QUFDWDtBQUV1TCIsInNvdXJjZXMiOlsid2VicGFjazovL3plbmJvYXJkLy4vbm9kZV9tb2R1bGVzL0BlZGdlc3RvcmUvc2VydmVyL2Rpc3Qvc2hhcmVkLTZkZWE5ZTkxLm1qcz9iZmI2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGhrZGYgfSBmcm9tICdAcGFudmEvaGtkZic7XG5pbXBvcnQgeyBzZXJpYWxpemUgfSBmcm9tICdjb29raWUnO1xuaW1wb3J0IHsgRW5jcnlwdEpXVCwgand0RGVjcnlwdCB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0IHsgdjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCB7IF8gfSBmcm9tICdAc3djL2hlbHBlcnMvXy9fZGVmaW5lX3Byb3BlcnR5JztcblxuY29uc3QgRURHRV9TVE9SRV9FUlJPUl9DT0RFUyA9IHtcbiAgICBCQURfUkVRVUVTVDogNDAwLFxuICAgIFVOQVVUSE9SSVpFRDogNDAxXG59O1xuY2xhc3MgRWRnZVN0b3JlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgY29uc3RydWN0b3Iob3B0cyl7XG4gICAgICAgIHN1cGVyKG9wdHMubWVzc2FnZSk7XG4gICAgICAgIF8odGhpcywgXCJjYXVzZVwiLCB2b2lkIDApO1xuICAgICAgICBfKHRoaXMsIFwiY29kZVwiLCB2b2lkIDApO1xuICAgICAgICB0aGlzLm5hbWUgPSAnRWRnZVN0b3JlRXJyb3InO1xuICAgICAgICB0aGlzLmNvZGUgPSBvcHRzLmNvZGU7XG4gICAgICAgIHRoaXMuY2F1c2UgPSBvcHRzLmNhdXNlO1xuICAgIH1cbn1cblxuY29uc3QgSU1BR0VfTUlNRV9UWVBFUyA9IFtcbiAgICAnaW1hZ2UvanBlZycsXG4gICAgJ2ltYWdlL3BuZycsXG4gICAgJ2ltYWdlL2dpZicsXG4gICAgJ2ltYWdlL3dlYnAnLFxuICAgICdpbWFnZS9zdmcreG1sJyxcbiAgICAnaW1hZ2UvdGlmZicsXG4gICAgJ2ltYWdlL2JtcCcsXG4gICAgJ2ltYWdlL3gtaWNvbidcbl07XG5cbi8vIFRPRE86IGNoYW5nZSBpdCB0byAxIGhvdXIgd2hlbiB3ZSBoYXZlIGEgd2F5IHRvIHJlZnJlc2ggdGhlIHRva2VuXG5jb25zdCBERUZBVUxUX01BWF9BR0UgPSAzMCAqIDI0ICogNjAgKiA2MDsgLy8gMzAgZGF5c1xuYXN5bmMgZnVuY3Rpb24gaW5pdChwYXJhbXMpIHtcbiAgICBjb25zdCB7IGN0eCwgcHJvdmlkZXIsIHJvdXRlciB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IGN0eFRva2VuID0gYXdhaXQgZW5jcnlwdEpXVChjdHgpO1xuICAgIGNvbnN0IHsgdG9rZW4gfSA9IGF3YWl0IHByb3ZpZGVyLmluaXQoe1xuICAgICAgICBjdHgsXG4gICAgICAgIHJvdXRlcjogcm91dGVyXG4gICAgfSk7XG4gICAgY29uc3QgbmV3Q29va2llcyA9IFtcbiAgICAgICAgc2VyaWFsaXplKCdlZGdlc3RvcmUtY3R4JywgY3R4VG9rZW4sIHtcbiAgICAgICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgICAgIG1heEFnZTogREVGQVVMVF9NQVhfQUdFXG4gICAgICAgIH0pXG4gICAgXTtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgbmV3Q29va2llcy5wdXNoKHNlcmlhbGl6ZSgnZWRnZXN0b3JlLXRva2VuJywgdG9rZW4sIHtcbiAgICAgICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgICAgIG1heEFnZTogREVGQVVMVF9NQVhfQUdFXG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY29uc3QgYmFzZVVybCA9IGF3YWl0IHByb3ZpZGVyLmdldEJhc2VVcmwoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBuZXdDb29raWVzLFxuICAgICAgICB0b2tlbixcbiAgICAgICAgYmFzZVVybFxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiByZXF1ZXN0VXBsb2FkKHBhcmFtcykge1xuICAgIGNvbnN0IHsgcHJvdmlkZXIsIHJvdXRlciwgY3R4VG9rZW4sIGJvZHk6IHsgYnVja2V0TmFtZSwgaW5wdXQsIGZpbGVJbmZvIH0gfSA9IHBhcmFtcztcbiAgICBpZiAoIWN0eFRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnTWlzc2luZyBlZGdlc3RvcmUtY3R4IGNvb2tpZScsXG4gICAgICAgICAgICBjb2RlOiAnVU5BVVRIT1JJWkVEJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3R4ID0gYXdhaXQgZ2V0Q29udGV4dChjdHhUb2tlbik7XG4gICAgY29uc3QgYnVja2V0ID0gcm91dGVyLmJ1Y2tldHNbYnVja2V0TmFtZV07XG4gICAgaWYgKCFidWNrZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCdWNrZXQgJHtidWNrZXROYW1lfSBub3QgZm91bmRgKTtcbiAgICB9XG4gICAgaWYgKGJ1Y2tldC5fZGVmLmJlZm9yZVVwbG9hZCkge1xuICAgICAgICBjb25zdCBjYW5VcGxvYWQgPSBhd2FpdCBidWNrZXQuX2RlZi5iZWZvcmVVcGxvYWQ/Lih7XG4gICAgICAgICAgICBjdHgsXG4gICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgIGZpbGVJbmZvOiB7XG4gICAgICAgICAgICAgICAgc2l6ZTogZmlsZUluZm8uc2l6ZSxcbiAgICAgICAgICAgICAgICB0eXBlOiBmaWxlSW5mby50eXBlLFxuICAgICAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlSW5mby5maWxlTmFtZSxcbiAgICAgICAgICAgICAgICBleHRlbnNpb246IGZpbGVJbmZvLmV4dGVuc2lvbixcbiAgICAgICAgICAgICAgICByZXBsYWNlVGFyZ2V0VXJsOiBmaWxlSW5mby5yZXBsYWNlVGFyZ2V0VXJsLFxuICAgICAgICAgICAgICAgIHRlbXBvcmFyeTogZmlsZUluZm8udGVtcG9yYXJ5XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIWNhblVwbG9hZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVcGxvYWQgbm90IGFsbG93ZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoYnVja2V0Ll9kZWYudHlwZSA9PT0gJ0lNQUdFJykge1xuICAgICAgICBpZiAoIUlNQUdFX01JTUVfVFlQRVMuaW5jbHVkZXMoZmlsZUluZm8udHlwZSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogJ0JBRF9SRVFVRVNUJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnT25seSBpbWFnZXMgYXJlIGFsbG93ZWQgaW4gdGhpcyBidWNrZXQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoYnVja2V0Ll9kZWYuYnVja2V0Q29uZmlnPy5tYXhTaXplKSB7XG4gICAgICAgIGlmIChmaWxlSW5mby5zaXplID4gYnVja2V0Ll9kZWYuYnVja2V0Q29uZmlnLm1heFNpemUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogJ0JBRF9SRVFVRVNUJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRmlsZSBzaXplIGlzIHRvbyBiaWcuIE1heCBzaXplIGlzICR7YnVja2V0Ll9kZWYuYnVja2V0Q29uZmlnLm1heFNpemV9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGJ1Y2tldC5fZGVmLmJ1Y2tldENvbmZpZz8uYWNjZXB0KSB7XG4gICAgICAgIGNvbnN0IGFjY2VwdCA9IGJ1Y2tldC5fZGVmLmJ1Y2tldENvbmZpZy5hY2NlcHQ7XG4gICAgICAgIGxldCBhY2NlcHRlZCA9IGZhbHNlO1xuICAgICAgICBmb3IgKGNvbnN0IGFjY2VwdGVkTWltZVR5cGUgb2YgYWNjZXB0KXtcbiAgICAgICAgICAgIGlmIChhY2NlcHRlZE1pbWVUeXBlLmVuZHNXaXRoKCcvKicpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWltZVR5cGUgPSBhY2NlcHRlZE1pbWVUeXBlLnJlcGxhY2UoJy8qJywgJycpO1xuICAgICAgICAgICAgICAgIGlmIChmaWxlSW5mby50eXBlLnN0YXJ0c1dpdGgobWltZVR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChmaWxlSW5mby50eXBlID09PSBhY2NlcHRlZE1pbWVUeXBlKSB7XG4gICAgICAgICAgICAgICAgYWNjZXB0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghYWNjZXB0ZWQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogJ0JBRF9SRVFVRVNUJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgXCIke2ZpbGVJbmZvLnR5cGV9XCIgaXMgbm90IGFsbG93ZWQuIEFjY2VwdGVkIHR5cGVzIGFyZSAke0pTT04uc3RyaW5naWZ5KGFjY2VwdCl9YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcGF0aCA9IGJ1aWxkUGF0aCh7XG4gICAgICAgIGZpbGVJbmZvLFxuICAgICAgICBidWNrZXQsXG4gICAgICAgIHBhdGhBdHRyczoge1xuICAgICAgICAgICAgY3R4LFxuICAgICAgICAgICAgaW5wdXRcbiAgICAgICAgfVxuICAgIH0pO1xuICAgIGNvbnN0IG1ldGFkYXRhID0gYXdhaXQgYnVja2V0Ll9kZWYubWV0YWRhdGE/Lih7XG4gICAgICAgIGN0eCxcbiAgICAgICAgaW5wdXRcbiAgICB9KTtcbiAgICBjb25zdCBpc1B1YmxpYyA9IGJ1Y2tldC5fZGVmLmFjY2Vzc0NvbnRyb2wgPT09IHVuZGVmaW5lZDtcbiAgICBjb25zdCByZXF1ZXN0VXBsb2FkUmVzID0gYXdhaXQgcHJvdmlkZXIucmVxdWVzdFVwbG9hZCh7XG4gICAgICAgIGJ1Y2tldE5hbWUsXG4gICAgICAgIGJ1Y2tldFR5cGU6IGJ1Y2tldC5fZGVmLnR5cGUsXG4gICAgICAgIGZpbGVJbmZvOiB7XG4gICAgICAgICAgICAuLi5maWxlSW5mbyxcbiAgICAgICAgICAgIHBhdGgsXG4gICAgICAgICAgICBpc1B1YmxpYyxcbiAgICAgICAgICAgIG1ldGFkYXRhXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICBjb25zdCBwYXJzZWRQYXRoID0gcGF0aC5yZWR1Y2UoKGFjYywgY3Vycik9PntcbiAgICAgICAgYWNjW2N1cnIua2V5XSA9IGN1cnIudmFsdWU7XG4gICAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuICAgIGNvbnN0IHBhdGhPcmRlciA9IHBhdGgubWFwKChwKT0+cC5rZXkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLnJlcXVlc3RVcGxvYWRSZXMsXG4gICAgICAgIHNpemU6IGZpbGVJbmZvLnNpemUsXG4gICAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgcGF0aDogcGFyc2VkUGF0aCxcbiAgICAgICAgcGF0aE9yZGVyLFxuICAgICAgICBtZXRhZGF0YVxuICAgIH07XG59XG5hc3luYyBmdW5jdGlvbiByZXF1ZXN0VXBsb2FkUGFydHMocGFyYW1zKSB7XG4gICAgY29uc3QgeyBwcm92aWRlciwgcm91dGVyLCBjdHhUb2tlbiwgYm9keTogeyBtdWx0aXBhcnQsIHBhdGggfSB9ID0gcGFyYW1zO1xuICAgIGlmICghY3R4VG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVkZ2VTdG9yZUVycm9yKHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdNaXNzaW5nIGVkZ2VzdG9yZS1jdHggY29va2llJyxcbiAgICAgICAgICAgIGNvZGU6ICdVTkFVVEhPUklaRUQnXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBnZXRDb250ZXh0KGN0eFRva2VuKTsgLy8ganVzdCB0byBjaGVjayBpZiB0aGUgdG9rZW4gaXMgdmFsaWRcbiAgICBjb25zdCBidWNrZXQgPSByb3V0ZXIuYnVja2V0c1ttdWx0aXBhcnQudXBsb2FkSWRdO1xuICAgIGlmICghYnVja2V0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQnVja2V0ICR7bXVsdGlwYXJ0LnVwbG9hZElkfSBub3QgZm91bmRgKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHByb3ZpZGVyLnJlcXVlc3RVcGxvYWRQYXJ0cyh7XG4gICAgICAgIG11bHRpcGFydCxcbiAgICAgICAgcGF0aFxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gY29tcGxldGVNdWx0aXBhcnRVcGxvYWQocGFyYW1zKSB7XG4gICAgY29uc3QgeyBwcm92aWRlciwgcm91dGVyLCBjdHhUb2tlbiwgYm9keTogeyBidWNrZXROYW1lLCB1cGxvYWRJZCwga2V5LCBwYXJ0cyB9IH0gPSBwYXJhbXM7XG4gICAgaWYgKCFjdHhUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgRWRnZVN0b3JlRXJyb3Ioe1xuICAgICAgICAgICAgbWVzc2FnZTogJ01pc3NpbmcgZWRnZXN0b3JlLWN0eCBjb29raWUnLFxuICAgICAgICAgICAgY29kZTogJ1VOQVVUSE9SSVpFRCdcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGdldENvbnRleHQoY3R4VG9rZW4pOyAvLyBqdXN0IHRvIGNoZWNrIGlmIHRoZSB0b2tlbiBpcyB2YWxpZFxuICAgIGNvbnN0IGJ1Y2tldCA9IHJvdXRlci5idWNrZXRzW2J1Y2tldE5hbWVdO1xuICAgIGlmICghYnVja2V0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQnVja2V0ICR7YnVja2V0TmFtZX0gbm90IGZvdW5kYCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBwcm92aWRlci5jb21wbGV0ZU11bHRpcGFydFVwbG9hZCh7XG4gICAgICAgIHVwbG9hZElkLFxuICAgICAgICBrZXksXG4gICAgICAgIHBhcnRzXG4gICAgfSk7XG59XG5hc3luYyBmdW5jdGlvbiBjb25maXJtVXBsb2FkKHBhcmFtcykge1xuICAgIGNvbnN0IHsgcHJvdmlkZXIsIHJvdXRlciwgY3R4VG9rZW4sIGJvZHk6IHsgYnVja2V0TmFtZSwgdXJsIH0gfSA9IHBhcmFtcztcbiAgICBpZiAoIWN0eFRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnTWlzc2luZyBlZGdlc3RvcmUtY3R4IGNvb2tpZScsXG4gICAgICAgICAgICBjb2RlOiAnVU5BVVRIT1JJWkVEJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgZ2V0Q29udGV4dChjdHhUb2tlbik7IC8vIGp1c3QgdG8gY2hlY2sgaWYgdGhlIHRva2VuIGlzIHZhbGlkXG4gICAgY29uc3QgYnVja2V0ID0gcm91dGVyLmJ1Y2tldHNbYnVja2V0TmFtZV07XG4gICAgaWYgKCFidWNrZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCdWNrZXQgJHtidWNrZXROYW1lfSBub3QgZm91bmRgKTtcbiAgICB9XG4gICAgcmV0dXJuIGF3YWl0IHByb3ZpZGVyLmNvbmZpcm1VcGxvYWQoe1xuICAgICAgICBidWNrZXQsXG4gICAgICAgIHVybDogdW5wcm94eVVybCh1cmwpXG4gICAgfSk7XG59XG5hc3luYyBmdW5jdGlvbiBkZWxldGVGaWxlKHBhcmFtcykge1xuICAgIGNvbnN0IHsgcHJvdmlkZXIsIHJvdXRlciwgY3R4VG9rZW4sIGJvZHk6IHsgYnVja2V0TmFtZSwgdXJsIH0gfSA9IHBhcmFtcztcbiAgICBpZiAoIWN0eFRva2VuKSB7XG4gICAgICAgIHRocm93IG5ldyBFZGdlU3RvcmVFcnJvcih7XG4gICAgICAgICAgICBtZXNzYWdlOiAnTWlzc2luZyBlZGdlc3RvcmUtY3R4IGNvb2tpZScsXG4gICAgICAgICAgICBjb2RlOiAnVU5BVVRIT1JJWkVEJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgY3R4ID0gYXdhaXQgZ2V0Q29udGV4dChjdHhUb2tlbik7XG4gICAgY29uc3QgYnVja2V0ID0gcm91dGVyLmJ1Y2tldHNbYnVja2V0TmFtZV07XG4gICAgaWYgKCFidWNrZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBCdWNrZXQgJHtidWNrZXROYW1lfSBub3QgZm91bmRgKTtcbiAgICB9XG4gICAgaWYgKCFidWNrZXQuX2RlZi5iZWZvcmVEZWxldGUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbmVlZCB0byBkZWZpbmUgYmVmb3JlRGVsZXRlIGlmIHlvdSB3YW50IHRvIGRlbGV0ZSBmaWxlcyBkaXJlY3RseSBmcm9tIHRoZSBmcm9udGVuZC4nKTtcbiAgICB9XG4gICAgY29uc3QgZmlsZUluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRGaWxlKHtcbiAgICAgICAgdXJsXG4gICAgfSk7XG4gICAgY29uc3QgY2FuRGVsZXRlID0gYXdhaXQgYnVja2V0Ll9kZWYuYmVmb3JlRGVsZXRlKHtcbiAgICAgICAgY3R4LFxuICAgICAgICBmaWxlSW5mb1xuICAgIH0pO1xuICAgIGlmICghY2FuRGVsZXRlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRGVsZXRlIG5vdCBhbGxvd2VkJyk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBwcm92aWRlci5kZWxldGVGaWxlKHtcbiAgICAgICAgYnVja2V0LFxuICAgICAgICB1cmw6IHVucHJveHlVcmwodXJsKVxuICAgIH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gZW5jcnlwdEpXVChjdHgpIHtcbiAgICBjb25zdCBzZWNyZXQgPSBwcm9jZXNzLmVudi5FREdFX1NUT1JFX0pXVF9TRUNSRVQgPz8gcHJvY2Vzcy5lbnYuRURHRV9TVE9SRV9TRUNSRVRfS0VZO1xuICAgIGlmICghc2VjcmV0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRURHRV9TVE9SRV9KV1RfU0VDUkVUIG9yIEVER0VfU1RPUkVfU0VDUkVUX0tFWSBpcyBub3QgZGVmaW5lZCcpO1xuICAgIH1cbiAgICBjb25zdCBlbmNyeXB0aW9uU2VjcmV0ID0gYXdhaXQgZ2V0RGVyaXZlZEVuY3J5cHRpb25LZXkoc2VjcmV0KTtcbiAgICByZXR1cm4gYXdhaXQgbmV3IEVuY3J5cHRKV1QoY3R4KS5zZXRQcm90ZWN0ZWRIZWFkZXIoe1xuICAgICAgICBhbGc6ICdkaXInLFxuICAgICAgICBlbmM6ICdBMjU2R0NNJ1xuICAgIH0pLnNldElzc3VlZEF0KCkuc2V0RXhwaXJhdGlvblRpbWUoRGF0ZS5ub3coKSAvIDEwMDAgKyBERUZBVUxUX01BWF9BR0UpLnNldEp0aSh2NCgpKS5lbmNyeXB0KGVuY3J5cHRpb25TZWNyZXQpO1xufVxuYXN5bmMgZnVuY3Rpb24gZGVjcnlwdEpXVCh0b2tlbikge1xuICAgIGNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LkVER0VfU1RPUkVfSldUX1NFQ1JFVCA/PyBwcm9jZXNzLmVudi5FREdFX1NUT1JFX1NFQ1JFVF9LRVk7XG4gICAgaWYgKCFzZWNyZXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdFREdFX1NUT1JFX0pXVF9TRUNSRVQgb3IgRURHRV9TVE9SRV9TRUNSRVRfS0VZIGlzIG5vdCBzZXQnKTtcbiAgICB9XG4gICAgY29uc3QgZW5jcnlwdGlvblNlY3JldCA9IGF3YWl0IGdldERlcml2ZWRFbmNyeXB0aW9uS2V5KHNlY3JldCk7XG4gICAgY29uc3QgeyBwYXlsb2FkIH0gPSBhd2FpdCBqd3REZWNyeXB0KHRva2VuLCBlbmNyeXB0aW9uU2VjcmV0LCB7XG4gICAgICAgIGNsb2NrVG9sZXJhbmNlOiAxNVxuICAgIH0pO1xuICAgIHJldHVybiBwYXlsb2FkO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0RGVyaXZlZEVuY3J5cHRpb25LZXkoc2VjcmV0KSB7XG4gICAgcmV0dXJuIGF3YWl0IGhrZGYoJ3NoYTI1NicsIHNlY3JldCwgJycsICdFZGdlIFN0b3JlIEdlbmVyYXRlZCBFbmNyeXB0aW9uIEtleScsIDMyKTtcbn1cbmZ1bmN0aW9uIGJ1aWxkUGF0aChwYXJhbXMpIHtcbiAgICBjb25zdCB7IGJ1Y2tldCB9ID0gcGFyYW1zO1xuICAgIGNvbnN0IHBhdGhQYXJhbXMgPSBidWNrZXQuX2RlZi5wYXRoO1xuICAgIGNvbnN0IHBhdGggPSBwYXRoUGFyYW1zLm1hcCgocGFyYW0pPT57XG4gICAgICAgIGNvbnN0IHBhcmFtRW50cmllcyA9IE9iamVjdC5lbnRyaWVzKHBhcmFtKTtcbiAgICAgICAgaWYgKHBhcmFtRW50cmllc1swXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgcGF0aCBwYXJhbScpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IFtrZXksIHZhbHVlXSA9IHBhcmFtRW50cmllc1swXTtcbiAgICAgICAgLy8gdGhpcyBpcyBhIHN0cmluZyBsaWtlOiBcImN0eC54eHhcIiBvciBcImlucHV0Lnl5eS56enpcIlxuICAgICAgICBjb25zdCBjdXJyUGFyYW1WYWwgPSB2YWx1ZSgpLnNwbGl0KCcuJykucmVkdWNlKChhY2MyLCBrZXkpPT57XG4gICAgICAgICAgICBpZiAoYWNjMltrZXldID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1pc3Npbmcga2V5ICR7a2V5fSBpbiAke0pTT04uc3RyaW5naWZ5KGFjYzIpfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGFjYzJba2V5XTtcbiAgICAgICAgfSwgcGFyYW1zLnBhdGhBdHRycyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBrZXksXG4gICAgICAgICAgICB2YWx1ZTogY3VyclBhcmFtVmFsXG4gICAgICAgIH07XG4gICAgfSk7XG4gICAgcmV0dXJuIHBhdGg7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRDb250ZXh0KHRva2VuKSB7XG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHRva2VuJyk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBkZWNyeXB0SldUKHRva2VuKTtcbn1cbi8qKlxuICogT24gbG9jYWwgZGV2ZWxvcG1lbnQsIHByb3RlY3RlZCBmaWxlcyBhcmUgcHJveGllZCB0byB0aGUgc2VydmVyLFxuICogd2hpY2ggY2hhbmdlcyB0aGUgb3JpZ2luYWwgVVJMLlxuICpcbiAqIFRoaXMgZnVuY3Rpb24gaXMgdXNlZCB0byBnZXQgdGhlIG9yaWdpbmFsIFVSTCxcbiAqIHNvIHRoYXQgd2UgY2FuIGRlbGV0ZSBvciBjb25maXJtIHRoZSB1cGxvYWQuXG4gKi8gZnVuY3Rpb24gdW5wcm94eVVybCh1cmwpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgJiYgdXJsLnN0YXJ0c1dpdGgoJ2h0dHA6Ly8nKSkge1xuICAgICAgICAvLyBnZXQgdGhlIHVybCBwYXJhbSBmcm9tIHRoZSBxdWVyeSBzdHJpbmdcbiAgICAgICAgY29uc3QgdXJsUGFyYW0gPSBuZXcgVVJMKHVybCkuc2VhcmNoUGFyYW1zLmdldCgndXJsJyk7XG4gICAgICAgIGlmICh1cmxQYXJhbSkge1xuICAgICAgICAgICAgcmV0dXJuIHVybFBhcmFtO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG59XG5cbmV4cG9ydCB7IEVkZ2VTdG9yZUVycm9yIGFzIEUsIHJlcXVlc3RVcGxvYWRQYXJ0cyBhcyBhLCBjb25maXJtVXBsb2FkIGFzIGIsIGNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkIGFzIGMsIGRlbGV0ZUZpbGUgYXMgZCwgRURHRV9TVE9SRV9FUlJPUl9DT0RFUyBhcyBlLCBpbml0IGFzIGksIHJlcXVlc3RVcGxvYWQgYXMgciB9O1xuIl0sIm5hbWVzIjpbImhrZGYiLCJzZXJpYWxpemUiLCJFbmNyeXB0SldUIiwiand0RGVjcnlwdCIsInY0IiwiXyIsIkVER0VfU1RPUkVfRVJST1JfQ09ERVMiLCJCQURfUkVRVUVTVCIsIlVOQVVUSE9SSVpFRCIsIkVkZ2VTdG9yZUVycm9yIiwiRXJyb3IiLCJjb25zdHJ1Y3RvciIsIm9wdHMiLCJtZXNzYWdlIiwibmFtZSIsImNvZGUiLCJjYXVzZSIsIklNQUdFX01JTUVfVFlQRVMiLCJERUZBVUxUX01BWF9BR0UiLCJpbml0IiwicGFyYW1zIiwiY3R4IiwicHJvdmlkZXIiLCJyb3V0ZXIiLCJjdHhUb2tlbiIsImVuY3J5cHRKV1QiLCJ0b2tlbiIsIm5ld0Nvb2tpZXMiLCJwYXRoIiwibWF4QWdlIiwicHVzaCIsImJhc2VVcmwiLCJnZXRCYXNlVXJsIiwicmVxdWVzdFVwbG9hZCIsImJvZHkiLCJidWNrZXROYW1lIiwiaW5wdXQiLCJmaWxlSW5mbyIsImdldENvbnRleHQiLCJidWNrZXQiLCJidWNrZXRzIiwiX2RlZiIsImJlZm9yZVVwbG9hZCIsImNhblVwbG9hZCIsInNpemUiLCJ0eXBlIiwiZmlsZU5hbWUiLCJleHRlbnNpb24iLCJyZXBsYWNlVGFyZ2V0VXJsIiwidGVtcG9yYXJ5IiwiaW5jbHVkZXMiLCJidWNrZXRDb25maWciLCJtYXhTaXplIiwiYWNjZXB0IiwiYWNjZXB0ZWQiLCJhY2NlcHRlZE1pbWVUeXBlIiwiZW5kc1dpdGgiLCJtaW1lVHlwZSIsInJlcGxhY2UiLCJzdGFydHNXaXRoIiwiSlNPTiIsInN0cmluZ2lmeSIsImJ1aWxkUGF0aCIsInBhdGhBdHRycyIsIm1ldGFkYXRhIiwiaXNQdWJsaWMiLCJhY2Nlc3NDb250cm9sIiwidW5kZWZpbmVkIiwicmVxdWVzdFVwbG9hZFJlcyIsImJ1Y2tldFR5cGUiLCJwYXJzZWRQYXRoIiwicmVkdWNlIiwiYWNjIiwiY3VyciIsImtleSIsInZhbHVlIiwicGF0aE9yZGVyIiwibWFwIiwicCIsInVwbG9hZGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJyZXF1ZXN0VXBsb2FkUGFydHMiLCJtdWx0aXBhcnQiLCJ1cGxvYWRJZCIsImNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkIiwicGFydHMiLCJjb25maXJtVXBsb2FkIiwidXJsIiwidW5wcm94eVVybCIsImRlbGV0ZUZpbGUiLCJiZWZvcmVEZWxldGUiLCJnZXRGaWxlIiwiY2FuRGVsZXRlIiwic2VjcmV0IiwicHJvY2VzcyIsImVudiIsIkVER0VfU1RPUkVfSldUX1NFQ1JFVCIsIkVER0VfU1RPUkVfU0VDUkVUX0tFWSIsImVuY3J5cHRpb25TZWNyZXQiLCJnZXREZXJpdmVkRW5jcnlwdGlvbktleSIsInNldFByb3RlY3RlZEhlYWRlciIsImFsZyIsImVuYyIsInNldElzc3VlZEF0Iiwic2V0RXhwaXJhdGlvblRpbWUiLCJub3ciLCJzZXRKdGkiLCJlbmNyeXB0IiwiZGVjcnlwdEpXVCIsInBheWxvYWQiLCJjbG9ja1RvbGVyYW5jZSIsInBhdGhQYXJhbXMiLCJwYXJhbSIsInBhcmFtRW50cmllcyIsIk9iamVjdCIsImVudHJpZXMiLCJjdXJyUGFyYW1WYWwiLCJzcGxpdCIsImFjYzIiLCJ1cmxQYXJhbSIsIlVSTCIsInNlYXJjaFBhcmFtcyIsImdldCIsIkUiLCJhIiwiYiIsImMiLCJkIiwiZSIsImkiLCJyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/@edgestore/server/dist/shared-6dea9e91.mjs\n");

/***/ })

};
;